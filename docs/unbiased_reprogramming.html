<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-99.9.9">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Jialei Duan">
<title>Reprogram-Seq - Unbiased Reprogramming with 48 Factors by Reprogram-Seq</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./rational_epicardial_reprogramming.html" rel="next">
<link href="./favicon.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-DFTWE6RXHL"></script><script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-DFTWE6RXHL', { 'anonymize_ip': true});
</script><link rel="stylesheet" href="styles.css">
<meta property="og:title" content="Reprogram-Seq - Unbiased Reprogramming with 48 Factors by Reprogram-Seq">
<meta property="og:description" content="Reprogram-Seq leverages organ-specific cell atlas data with single-cell perturbation and computational analysis to predict, evaluate, and optimize TF combinations that reprogram a cell type of interest.">
<meta property="og:image" content="https://jlduan.github.io/Reprogram-Seq/workflow.jpg">
<meta property="og:site-name" content="Reprogram-Seq">
<meta name="twitter:title" content="Rational Reprogramming of Cellular States by Combinatorial Perturbation">
<meta name="twitter:description" content="Reprogram-Seq leverages organ-specific cell atlas data with single-cell perturbation and computational analysis to predict, evaluate, and optimize TF combinations that reprogram a cell type of interest.">
<meta name="twitter:image" content="https://jlduan.github.io/Reprogram-Seq/workflow.jpg">
<meta name="twitter:creator" content="@jlduan">
<meta name="twitter:card" content="summary_large_image">
<meta name="citation_title" content="Rational Reprogramming of Cellular States by Combinatorial Perturbation">
<meta name="citation_abstract" content="Reprogram-Seq leverages organ-specific cell atlas data with single-cell perturbation and computational analysis to predict, evaluate, and optimize TF combinations that reprogram a cell type of interest.
">
<meta name="citation_keywords" content="cellular reprogramming,single-cell RNA-Seq,single-cell perturbation,transcription factor,cardiac
">
<meta name="citation_author" content="Jialei Duan">
<meta name="citation_author" content="Boxun Li">
<meta name="citation_author" content="Minoti Bhakta">
<meta name="citation_author" content="Shiqi Xie">
<meta name="citation_author" content="Pei Zhou">
<meta name="citation_author" content="Nikhil V.Munshi">
<meta name="citation_author" content="Gary C.Hon">
<meta name="citation_publication_date" content="2023-03-08">
<meta name="citation_cover_date" content="2023-03-08">
<meta name="citation_year" content="2023">
<meta name="citation_online_date" content="2019-06-18">
<meta name="citation_fulltext_html_url" content="https://doi.org/10.1016/j.celrep.2019.05.079">
<meta name="citation_issue" content="12">
<meta name="citation_doi" content="10.1016/j.celrep.2019.05.079">
<meta name="citation_pmid" content="31216470">
<meta name="citation_volume" content="27">
<meta name="citation_language" content="en">
<meta name="citation_firstpage" content="3486">
<meta name="citation_lastpage" content="3499000000">
<meta name="citation_journal_title" content="Cell reports">
<meta name="citation_publisher" content="Cell Press">
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./unbiased_reprogramming.html">Unbiased Screen</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-center sidebar-header sidebar-header-stacked">
      <a href="./index.html" class="sidebar-logo-link">
      <img src="./logo.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none"></a>
    <div class="sidebar-title mb-0 py-0">
      <a href="./"><strong>Reprogram-Seq</strong></a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/jlduan" title="Reprogram-Seq" class="quarto-navigation-tool px-1" aria-label="Reprogram-Seq"><i class="bi bi-globe"></i></a>
    <a href="https://github.com/jlduan/Reprogram-Seq" title="GitHub" class="quarto-navigation-tool px-1" aria-label="GitHub"><i class="bi bi-github"></i></a>
    <a href="https://twitter.com/jlduan" title="Twitter" class="quarto-navigation-tool px-1" aria-label="Twitter"><i class="bi bi-twitter"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./unbiased_reprogramming.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Unbiased Screen</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rational_epicardial_reprogramming.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Rational Reprogramming</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./global_reprogramming_of_transcription.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Transcriptional Dynamics</span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li>
<a href="#preparation" id="toc-preparation" class="nav-link active" data-scroll-target="#preparation">Preparation</a>
  <ul>
<li><a href="#functions" id="toc-functions" class="nav-link" data-scroll-target="#functions">Functions</a></li>
  <li><a href="#symbols" id="toc-symbols" class="nav-link" data-scroll-target="#symbols">Symbols</a></li>
  <li><a href="#matrix" id="toc-matrix" class="nav-link" data-scroll-target="#matrix">Matrix</a></li>
  <li><a href="#embedding" id="toc-embedding" class="nav-link" data-scroll-target="#embedding">Embedding</a></li>
  </ul>
</li>
  <li>
<a href="#clustering" id="toc-clustering" class="nav-link" data-scroll-target="#clustering">Clustering</a>
  <ul>
<li><a href="#embedding-1" id="toc-embedding-1" class="nav-link" data-scroll-target="#embedding-1">Embedding</a></li>
  <li><a href="#composition" id="toc-composition" class="nav-link" data-scroll-target="#composition">Composition</a></li>
  </ul>
</li>
  <li>
<a href="#expression" id="toc-expression" class="nav-link" data-scroll-target="#expression">Expression</a>
  <ul>
<li><a href="#embedding-2" id="toc-embedding-2" class="nav-link" data-scroll-target="#embedding-2">Embedding</a></li>
  <li><a href="#violin" id="toc-violin" class="nav-link" data-scroll-target="#violin">Violin</a></li>
  <li><a href="#bar-plot" id="toc-bar-plot" class="nav-link" data-scroll-target="#bar-plot">Bar plot</a></li>
  <li><a href="#lollipop" id="toc-lollipop" class="nav-link" data-scroll-target="#lollipop">Lollipop</a></li>
  </ul>
</li>
  <li><a href="#gene-ontology-enrichment" id="toc-gene-ontology-enrichment" class="nav-link" data-scroll-target="#gene-ontology-enrichment">Gene Ontology enrichment</a></li>
  <li><a href="#enrichment-of-exogenous-factors" id="toc-enrichment-of-exogenous-factors" class="nav-link" data-scroll-target="#enrichment-of-exogenous-factors">Enrichment of exogenous factors</a></li>
  <li><a href="#r-session-info" id="toc-r-session-info" class="nav-link" data-scroll-target="#r-session-info">R session info</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title">Unbiased Reprogramming with 48 Factors by Reprogram-Seq</h1>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author"><a href="https://github.com/jlduan">Jialei Duan</a> <a href="https://orcid.org/0000-0003-4086-7461" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
  </div>
    <div class="quarto-title-meta-contents">
        <p class="affiliation">
            <a href="https://www.utsouthwestern.edu/education/medical-school/departments/green-center">
            Cecil H. and Ida Green Center for Reproductive Biology Sciences
            </a>
          </p>
      </div>
    </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">Wed Mar 8, 2023 18:04:50-06:00</p>
    </div>
  </div>
  
    
    <div>
    <div class="quarto-title-meta-heading">Doi</div>
    <div class="quarto-title-meta-contents">
      <p class="doi">
        <a href="https://doi.org/10.5281/zenodo.7109590">10.5281/zenodo.7109590</a>
      </p>
    </div>
  </div>
  </div>
  
<div>
  <div class="abstract">
    <div class="abstract-title">Abstract</div>
    <p>Reprogram-Seq leverages organ-specific cell atlas data with single-cell perturbation and computational analysis to predict, evaluate, and optimize TF combinations that reprogram a cell type of interest.</p>
  </div>
</div>

</header><p><br></p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2023-03-08 18:03:02 CST"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/timezones.html">Sys.timezone</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "America/Chicago"</code></pre>
</div>
</div>
<section id="preparation" class="level2"><h2 class="anchored" data-anchor-id="preparation">Preparation</h2>
<section id="functions" class="level3"><h3 class="anchored" data-anchor-id="functions">Functions</h3>
<p>Load required packages.</p>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://Matrix.R-forge.R-project.org/">Matrix</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com">patchwork</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/wch/extrafont">extrafont</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span>file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">SCRIPT_DIR</span>, <span class="st">"utilities.R"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">`%+replace%`</span> <span class="op">&lt;-</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="va">`%+replace%`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="symbols" class="level3"><h3 class="anchored" data-anchor-id="symbols">Symbols</h3>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">PROJECT_DIR</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span></span>
<span>    <span class="st">"/Users/jialei/Dropbox/Data/Projects/UTSW/Cellular_reprogramming"</span>,</span>
<span>    <span class="st">"Cardiac_reprogramming/Notebooks"</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">gene_symbols</span> <span class="op">&lt;-</span> <span class="fu">vroom</span><span class="fu">::</span><span class="fu"><a href="https://vroom.r-lib.org/reference/vroom.html">vroom</a></span><span class="op">(</span></span>
<span>    file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span></span>
<span>        <span class="va">PROJECT_DIR</span>, <span class="st">"data"</span>, <span class="st">"misc"</span>, <span class="st">"genes.tsv"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    col_names <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">gene_symbols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html">setNames</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">gene_symbols</span><span class="op">$</span><span class="va">X2</span>, nm <span class="op">=</span> <span class="va">gene_symbols</span><span class="op">$</span><span class="va">X1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gene_symbols</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ENSMUSG00000051951 ENSMUSG00000089699 ENSMUSG00000102343 ENSMUSG00000025900 
            "Xkr4"           "Gm1992"          "Gm37381"              "Rp1" 
ENSMUSG00000109048 ENSMUSG00000025902 
             "Rp1"            "Sox17" </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">gene_symbols</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 27999</code></pre>
</div>
</div>
</section><section id="matrix" class="level3"><h3 class="anchored" data-anchor-id="matrix">Matrix</h3>
<div class="cell">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">matrix_readcount_use</span> <span class="op">&lt;-</span> <span class="fu">Matrix</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/sparseMatrix.html">sparseMatrix</a></span><span class="op">(</span></span>
<span>    i <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span></span>
<span>            <span class="va">PROJECT_DIR</span>, <span class="st">"data/drop-seq"</span>, <span class="st">"expr_readcount_raw_csc_indices.rds"</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span></span>
<span>            <span class="va">PROJECT_DIR</span>, <span class="st">"data/drop-seq"</span>, <span class="st">"expr_readcount_raw_csc_indptr.rds"</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span></span>
<span>            <span class="va">PROJECT_DIR</span>, <span class="st">"data/drop-seq"</span>, <span class="st">"expr_readcount_raw_csc_values.rds"</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    dims <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span></span>
<span>            <span class="va">PROJECT_DIR</span>, <span class="st">"data/drop-seq"</span>, <span class="st">"expr_readcount_raw_csc_shape.rds"</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span></span>
<span>            <span class="va">PROJECT_DIR</span>, <span class="st">"data/drop-seq"</span>, <span class="st">"expr_readcount_raw_csc_dimnames.rds"</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    index1 <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">matrix_readcount_use</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 27999 27416</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">matrix_readcount_use</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">matrix_readcount_use</span><span class="op">)</span>,</span>
<span>    <span class="va">gene_symbols</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">matrix_readcount_use</span><span class="op">)</span><span class="op">]</span>,</span>
<span>    sep <span class="op">=</span> <span class="st">"_"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">matrix_readcount_use</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">JD126-1-2_TTTCTATATACA.bam</th>
<th style="text-align: right;">JD126-1-2_CCTAGAAACCAG.bam</th>
<th style="text-align: right;">JD126-1-2_TCATAGTCTATT.bam</th>
<th style="text-align: right;">JD126-1-2_ATGACCTTTCCC.bam</th>
<th style="text-align: right;">JD126-1-2_CATTAGTGATGG.bam</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">ENSMUSG00000051951_Xkr4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">ENSMUSG00000089699_Gm1992</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ENSMUSG00000102343_Gm37381</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">ENSMUSG00000025900_Rp1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ENSMUSG00000109048_Rp1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
</div>
</section><section id="embedding" class="level3"><h3 class="anchored" data-anchor-id="embedding">Embedding</h3>
<div class="cell">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">embedding</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span></span>
<span>    file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">PROJECT_DIR</span>, <span class="st">"data/drop-seq"</span>, <span class="st">"tsne_out_coords.rds"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">embedding</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 25776     7</code></pre>
</div>
</div>
<p><br></p>
<p>Check memory usage.</p>
<div class="cell">
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">walk</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">matrix_readcount_use</span>, <span class="va">embedding</span><span class="op">)</span>, \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/object.size.html">object.size</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, units <span class="op">=</span> <span class="st">"auto"</span>, standard <span class="op">=</span> <span class="st">"SI"</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>751.2 MB
3.4 MB</code></pre>
</div>
</div>
</section></section><section id="clustering" class="level2 page-columns page-full"><h2 class="anchored" data-anchor-id="clustering">Clustering</h2>
<div class="cell">
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">x_column</span> <span class="op">&lt;-</span> <span class="st">"x"</span></span>
<span><span class="va">y_column</span> <span class="op">&lt;-</span> <span class="st">"y"</span></span>
<span></span>
<span><span class="va">GEOM_POINT_SIZE</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span>
<span><span class="va">EMBEDDING_TITLE_PREFIX</span> <span class="op">&lt;-</span> <span class="st">"t-SNE"</span></span>
<span><span class="va">RASTERISED</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="embedding-1" class="level3 page-columns page-full"><h3 class="anchored" data-anchor-id="embedding-1">Embedding</h3>
<div class="cell">
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">embedding</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">rownames_to_column</a></span><span class="op">(</span>var <span class="op">=</span> <span class="st">"cell"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>        num_umis <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/colSums.html">colSums</a></span><span class="op">(</span><span class="va">matrix_readcount_use</span><span class="op">[</span>, <span class="va">cell</span><span class="op">]</span><span class="op">)</span>,</span>
<span>        num_features <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/colSums.html">colSums</a></span><span class="op">(</span><span class="va">matrix_readcount_use</span><span class="op">[</span>, <span class="va">cell</span><span class="op">]</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>batch <span class="op">=</span> <span class="va">batch.id</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">batch</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span></span>
<span>        num_cells <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        median_umis <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">num_umis</span><span class="op">)</span>,</span>
<span>        median_features <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">num_features</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/gt.html">gt</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/data_color.html">data_color</a></span><span class="op">(</span></span>
<span>        columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">median_umis</span><span class="op">)</span>,</span>
<span>        fn <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/col_numeric.html">col_numeric</a></span><span class="op">(</span></span>
<span>            palette <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>                <span class="st">"green"</span>, <span class="st">"orange"</span>, <span class="st">"red"</span></span>
<span>            <span class="op">)</span>,</span>
<span>            domain <span class="op">=</span> <span class="cn">NULL</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/fmt_number.html">fmt_number</a></span><span class="op">(</span></span>
<span>        columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">num_cells</span><span class="op">)</span>,</span>
<span>        sep_mark <span class="op">=</span> <span class="st">","</span>,</span>
<span>        decimals <span class="op">=</span> <span class="fl">0</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/fmt_number.html">fmt_number</a></span><span class="op">(</span></span>
<span>        columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">median_umis</span>, <span class="va">median_features</span><span class="op">)</span>,</span>
<span>        sep_mark <span class="op">=</span> <span class="st">","</span>,</span>
<span>        decimals <span class="op">=</span> <span class="fl">1</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/grand_summary_rows.html">grand_summary_rows</a></span><span class="op">(</span></span>
<span>        columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">batch</span><span class="op">)</span>,</span>
<span>        fns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>            Count <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span></span>
<span>        <span class="op">)</span>,</span>
<span>        fmt <span class="op">=</span> <span class="op">~</span> <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/fmt_number.html">fmt_number</a></span><span class="op">(</span><span class="va">.</span>, decimals <span class="op">=</span> <span class="fl">0</span>, use_seps <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/grand_summary_rows.html">grand_summary_rows</a></span><span class="op">(</span></span>
<span>        columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">num_cells</span><span class="op">:</span><span class="va">median_features</span><span class="op">)</span>,</span>
<span>        fns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>            Mean <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span></span>
<span>        <span class="op">)</span>,</span>
<span>        fmt <span class="op">=</span> <span class="op">~</span> <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/fmt_number.html">fmt_number</a></span><span class="op">(</span><span class="va">.</span>, decimals <span class="op">=</span> <span class="fl">1</span>, use_seps <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/grand_summary_rows.html">grand_summary_rows</a></span><span class="op">(</span></span>
<span>        columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">num_cells</span><span class="op">)</span>,</span>
<span>        fns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>            Sum <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span></span>
<span>        <span class="op">)</span>,</span>
<span>        fmt <span class="op">=</span> <span class="op">~</span> <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/fmt_number.html">fmt_number</a></span><span class="op">(</span><span class="va">.</span>, decimals <span class="op">=</span> <span class="fl">0</span>, use_seps <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/tab_header.html">tab_header</a></span><span class="op">(</span></span>
<span>        title <span class="op">=</span> <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/md.html">md</a></span><span class="op">(</span><span class="st">"**Drop-Seq**; Batch"</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/tab_source_note.html">tab_source_note</a></span><span class="op">(</span></span>
<span>        source_note <span class="op">=</span> <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/md.html">md</a></span><span class="op">(</span></span>
<span>            <span class="st">"***[Here](https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE117795)** are the details.*"</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="tfqzdfwcgo" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#tfqzdfwcgo thead, #tfqzdfwcgo tbody, #tfqzdfwcgo tfoot, #tfqzdfwcgo tr, #tfqzdfwcgo td, #tfqzdfwcgo th {
  border-style: none;
}

#tfqzdfwcgo p {
  margin: 0;
  padding: 0;
}

#tfqzdfwcgo .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#tfqzdfwcgo .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#tfqzdfwcgo .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#tfqzdfwcgo .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#tfqzdfwcgo .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#tfqzdfwcgo .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#tfqzdfwcgo .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#tfqzdfwcgo .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#tfqzdfwcgo .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#tfqzdfwcgo .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#tfqzdfwcgo .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#tfqzdfwcgo .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#tfqzdfwcgo .gt_spanner_row {
  border-bottom-style: hidden;
}

#tfqzdfwcgo .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#tfqzdfwcgo .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#tfqzdfwcgo .gt_from_md > :first-child {
  margin-top: 0;
}

#tfqzdfwcgo .gt_from_md > :last-child {
  margin-bottom: 0;
}

#tfqzdfwcgo .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#tfqzdfwcgo .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#tfqzdfwcgo .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#tfqzdfwcgo .gt_row_group_first td {
  border-top-width: 2px;
}

#tfqzdfwcgo .gt_row_group_first th {
  border-top-width: 2px;
}

#tfqzdfwcgo .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#tfqzdfwcgo .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#tfqzdfwcgo .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#tfqzdfwcgo .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#tfqzdfwcgo .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#tfqzdfwcgo .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#tfqzdfwcgo .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#tfqzdfwcgo .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#tfqzdfwcgo .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#tfqzdfwcgo .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#tfqzdfwcgo .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#tfqzdfwcgo .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#tfqzdfwcgo .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#tfqzdfwcgo .gt_left {
  text-align: left;
}

#tfqzdfwcgo .gt_center {
  text-align: center;
}

#tfqzdfwcgo .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#tfqzdfwcgo .gt_font_normal {
  font-weight: normal;
}

#tfqzdfwcgo .gt_font_bold {
  font-weight: bold;
}

#tfqzdfwcgo .gt_font_italic {
  font-style: italic;
}

#tfqzdfwcgo .gt_super {
  font-size: 65%;
}

#tfqzdfwcgo .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#tfqzdfwcgo .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#tfqzdfwcgo .gt_indent_1 {
  text-indent: 5px;
}

#tfqzdfwcgo .gt_indent_2 {
  text-indent: 10px;
}

#tfqzdfwcgo .gt_indent_3 {
  text-indent: 15px;
}

#tfqzdfwcgo .gt_indent_4 {
  text-indent: 20px;
}

#tfqzdfwcgo .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading">
<td colspan="5" class="gt_heading gt_title gt_font_normal gt_bottom_border" style="">
<strong>Drop-Seq</strong>; Batch</td>
    </tr>
<tr class="gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id=""></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="batch">batch</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="num_cells">num_cells</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="median_umis">median_umis</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="median_features">median_features</th>
    </tr>
</thead>
<tbody class="gt_table_body">
<tr>
<th id="stub_1_1" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_1 batch" class="gt_row gt_left">JD126-1-2</td>
<td headers="stub_1_1 num_cells" class="gt_row gt_right">335</td>
<td headers="stub_1_1 median_umis" class="gt_row gt_right" style="background-color: #8BEB00; color: #000000;">3,697.0</td>
<td headers="stub_1_1 median_features" class="gt_row gt_right">1,839.0</td>
</tr>
<tr>
<th id="stub_1_2" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_2 batch" class="gt_row gt_left">JD126A1</td>
<td headers="stub_1_2 num_cells" class="gt_row gt_right">289</td>
<td headers="stub_1_2 median_umis" class="gt_row gt_right" style="background-color: #87EC00; color: #000000;">3,499.0</td>
<td headers="stub_1_2 median_features" class="gt_row gt_right">1,669.0</td>
</tr>
<tr>
<th id="stub_1_3" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_3 batch" class="gt_row gt_left">JD126A5</td>
<td headers="stub_1_3 num_cells" class="gt_row gt_right">310</td>
<td headers="stub_1_3 median_umis" class="gt_row gt_right" style="background-color: #88EC00; color: #000000;">3,575.0</td>
<td headers="stub_1_3 median_features" class="gt_row gt_right">1,759.5</td>
</tr>
<tr>
<th id="stub_1_4" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_4 batch" class="gt_row gt_left">JD126B</td>
<td headers="stub_1_4 num_cells" class="gt_row gt_right">625</td>
<td headers="stub_1_4 median_umis" class="gt_row gt_right" style="background-color: #89EB00; color: #000000;">3,604.0</td>
<td headers="stub_1_4 median_features" class="gt_row gt_right">1,733.0</td>
</tr>
<tr>
<th id="stub_1_5" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_5 batch" class="gt_row gt_left">JD131-A</td>
<td headers="stub_1_5 num_cells" class="gt_row gt_right">418</td>
<td headers="stub_1_5 median_umis" class="gt_row gt_right" style="background-color: #59F700; color: #000000;">1,765.0</td>
<td headers="stub_1_5 median_features" class="gt_row gt_right">1,105.0</td>
</tr>
<tr>
<th id="stub_1_6" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_6 batch" class="gt_row gt_left">JD131-B</td>
<td headers="stub_1_6 num_cells" class="gt_row gt_right">371</td>
<td headers="stub_1_6 median_umis" class="gt_row gt_right" style="background-color: #5DF700; color: #000000;">1,895.0</td>
<td headers="stub_1_6 median_features" class="gt_row gt_right">1,146.0</td>
</tr>
<tr>
<th id="stub_1_7" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_7 batch" class="gt_row gt_left">JD131-C</td>
<td headers="stub_1_7 num_cells" class="gt_row gt_right">381</td>
<td headers="stub_1_7 median_umis" class="gt_row gt_right" style="background-color: #5DF700; color: #000000;">1,894.0</td>
<td headers="stub_1_7 median_features" class="gt_row gt_right">1,168.0</td>
</tr>
<tr>
<th id="stub_1_8" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_8 batch" class="gt_row gt_left">JD135A</td>
<td headers="stub_1_8 num_cells" class="gt_row gt_right">101</td>
<td headers="stub_1_8 median_umis" class="gt_row gt_right" style="background-color: #80EE00; color: #000000;">3,203.0</td>
<td headers="stub_1_8 median_features" class="gt_row gt_right">1,521.0</td>
</tr>
<tr>
<th id="stub_1_9" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_9 batch" class="gt_row gt_left">JD135Y</td>
<td headers="stub_1_9 num_cells" class="gt_row gt_right">222</td>
<td headers="stub_1_9 median_umis" class="gt_row gt_right" style="background-color: #59F700; color: #000000;">1,755.5</td>
<td headers="stub_1_9 median_features" class="gt_row gt_right">1,007.0</td>
</tr>
<tr>
<th id="stub_1_10" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_10 batch" class="gt_row gt_left">JD135Z</td>
<td headers="stub_1_10 num_cells" class="gt_row gt_right">92</td>
<td headers="stub_1_10 median_umis" class="gt_row gt_right" style="background-color: #5DF700; color: #000000;">1,890.0</td>
<td headers="stub_1_10 median_features" class="gt_row gt_right">966.5</td>
</tr>
<tr>
<th id="stub_1_11" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_11 batch" class="gt_row gt_left">JD136A</td>
<td headers="stub_1_11 num_cells" class="gt_row gt_right">172</td>
<td headers="stub_1_11 median_umis" class="gt_row gt_right" style="background-color: #6BF400; color: #000000;">2,348.5</td>
<td headers="stub_1_11 median_features" class="gt_row gt_right">1,285.5</td>
</tr>
<tr>
<th id="stub_1_12" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_12 batch" class="gt_row gt_left">JD136B</td>
<td headers="stub_1_12 num_cells" class="gt_row gt_right">269</td>
<td headers="stub_1_12 median_umis" class="gt_row gt_right" style="background-color: #53F800; color: #000000;">1,603.0</td>
<td headers="stub_1_12 median_features" class="gt_row gt_right">975.0</td>
</tr>
<tr>
<th id="stub_1_13" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_13 batch" class="gt_row gt_left">JD136C</td>
<td headers="stub_1_13 num_cells" class="gt_row gt_right">168</td>
<td headers="stub_1_13 median_umis" class="gt_row gt_right" style="background-color: #3FFB00; color: #000000;">1,140.5</td>
<td headers="stub_1_13 median_features" class="gt_row gt_right">734.0</td>
</tr>
<tr>
<th id="stub_1_14" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_14 batch" class="gt_row gt_left">JD136DE</td>
<td headers="stub_1_14 num_cells" class="gt_row gt_right">370</td>
<td headers="stub_1_14 median_umis" class="gt_row gt_right" style="background-color: #39FC00; color: #000000;">1,042.5</td>
<td headers="stub_1_14 median_features" class="gt_row gt_right">694.0</td>
</tr>
<tr>
<th id="stub_1_15" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_15 batch" class="gt_row gt_left">JD136F</td>
<td headers="stub_1_15 num_cells" class="gt_row gt_right">251</td>
<td headers="stub_1_15 median_umis" class="gt_row gt_right" style="background-color: #58F700; color: #000000;">1,752.0</td>
<td headers="stub_1_15 median_features" class="gt_row gt_right">993.0</td>
</tr>
<tr>
<th id="stub_1_16" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_16 batch" class="gt_row gt_left">JD136G</td>
<td headers="stub_1_16 num_cells" class="gt_row gt_right">500</td>
<td headers="stub_1_16 median_umis" class="gt_row gt_right" style="background-color: #48FA00; color: #000000;">1,341.5</td>
<td headers="stub_1_16 median_features" class="gt_row gt_right">827.0</td>
</tr>
<tr>
<th id="stub_1_17" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_17 batch" class="gt_row gt_left">JD137A</td>
<td headers="stub_1_17 num_cells" class="gt_row gt_right">268</td>
<td headers="stub_1_17 median_umis" class="gt_row gt_right" style="background-color: #77F100; color: #000000;">2,796.5</td>
<td headers="stub_1_17 median_features" class="gt_row gt_right">1,410.5</td>
</tr>
<tr>
<th id="stub_1_18" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_18 batch" class="gt_row gt_left">JD145A1</td>
<td headers="stub_1_18 num_cells" class="gt_row gt_right">269</td>
<td headers="stub_1_18 median_umis" class="gt_row gt_right" style="background-color: #83ED00; color: #000000;">3,332.0</td>
<td headers="stub_1_18 median_features" class="gt_row gt_right">1,623.0</td>
</tr>
<tr>
<th id="stub_1_19" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_19 batch" class="gt_row gt_left">JD145A5</td>
<td headers="stub_1_19 num_cells" class="gt_row gt_right">267</td>
<td headers="stub_1_19 median_umis" class="gt_row gt_right" style="background-color: #7AF000; color: #000000;">2,911.0</td>
<td headers="stub_1_19 median_features" class="gt_row gt_right">1,503.0</td>
</tr>
<tr>
<th id="stub_1_20" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_20 batch" class="gt_row gt_left">JD145B1</td>
<td headers="stub_1_20 num_cells" class="gt_row gt_right">284</td>
<td headers="stub_1_20 median_umis" class="gt_row gt_right" style="background-color: #87EC00; color: #000000;">3,531.5</td>
<td headers="stub_1_20 median_features" class="gt_row gt_right">1,704.0</td>
</tr>
<tr>
<th id="stub_1_21" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_21 batch" class="gt_row gt_left">JD145B5</td>
<td headers="stub_1_21 num_cells" class="gt_row gt_right">287</td>
<td headers="stub_1_21 median_umis" class="gt_row gt_right" style="background-color: #5EF600; color: #000000;">1,905.0</td>
<td headers="stub_1_21 median_features" class="gt_row gt_right">1,045.0</td>
</tr>
<tr>
<th id="stub_1_22" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_22 batch" class="gt_row gt_left">JD145C</td>
<td headers="stub_1_22 num_cells" class="gt_row gt_right">169</td>
<td headers="stub_1_22 median_umis" class="gt_row gt_right" style="background-color: #68F400; color: #000000;">2,235.0</td>
<td headers="stub_1_22 median_features" class="gt_row gt_right">1,056.0</td>
</tr>
<tr>
<th id="stub_1_23" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_23 batch" class="gt_row gt_left">JD145D</td>
<td headers="stub_1_23 num_cells" class="gt_row gt_right">187</td>
<td headers="stub_1_23 median_umis" class="gt_row gt_right" style="background-color: #5AF700; color: #000000;">1,797.0</td>
<td headers="stub_1_23 median_features" class="gt_row gt_right">941.0</td>
</tr>
<tr>
<th id="stub_1_24" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_24 batch" class="gt_row gt_left">JD145E</td>
<td headers="stub_1_24 num_cells" class="gt_row gt_right">287</td>
<td headers="stub_1_24 median_umis" class="gt_row gt_right" style="background-color: #35FC00; color: #000000;">977.0</td>
<td headers="stub_1_24 median_features" class="gt_row gt_right">590.0</td>
</tr>
<tr>
<th id="stub_1_25" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_25 batch" class="gt_row gt_left">JD145F</td>
<td headers="stub_1_25 num_cells" class="gt_row gt_right">103</td>
<td headers="stub_1_25 median_umis" class="gt_row gt_right" style="background-color: #00FF00; color: #000000;">533.0</td>
<td headers="stub_1_25 median_features" class="gt_row gt_right">396.0</td>
</tr>
<tr>
<th id="stub_1_26" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_26 batch" class="gt_row gt_left">JD146A1</td>
<td headers="stub_1_26 num_cells" class="gt_row gt_right">530</td>
<td headers="stub_1_26 median_umis" class="gt_row gt_right" style="background-color: #80EE00; color: #000000;">3,210.5</td>
<td headers="stub_1_26 median_features" class="gt_row gt_right">1,555.5</td>
</tr>
<tr>
<th id="stub_1_27" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_27 batch" class="gt_row gt_left">JD146A5</td>
<td headers="stub_1_27 num_cells" class="gt_row gt_right">549</td>
<td headers="stub_1_27 median_umis" class="gt_row gt_right" style="background-color: #96E700; color: #000000;">4,260.0</td>
<td headers="stub_1_27 median_features" class="gt_row gt_right">1,935.0</td>
</tr>
<tr>
<th id="stub_1_28" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_28 batch" class="gt_row gt_left">JD146B1</td>
<td headers="stub_1_28 num_cells" class="gt_row gt_right">466</td>
<td headers="stub_1_28 median_umis" class="gt_row gt_right" style="background-color: #A1E300; color: #000000;">4,879.5</td>
<td headers="stub_1_28 median_features" class="gt_row gt_right">1,973.0</td>
</tr>
<tr>
<th id="stub_1_29" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_29 batch" class="gt_row gt_left">JD146B5</td>
<td headers="stub_1_29 num_cells" class="gt_row gt_right">444</td>
<td headers="stub_1_29 median_umis" class="gt_row gt_right" style="background-color: #91E900; color: #000000;">4,035.5</td>
<td headers="stub_1_29 median_features" class="gt_row gt_right">1,828.0</td>
</tr>
<tr>
<th id="stub_1_30" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_30 batch" class="gt_row gt_left">JD146C1</td>
<td headers="stub_1_30 num_cells" class="gt_row gt_right">452</td>
<td headers="stub_1_30 median_umis" class="gt_row gt_right" style="background-color: #A5E100; color: #000000;">5,129.5</td>
<td headers="stub_1_30 median_features" class="gt_row gt_right">2,004.5</td>
</tr>
<tr>
<th id="stub_1_31" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_31 batch" class="gt_row gt_left">JD146C5</td>
<td headers="stub_1_31 num_cells" class="gt_row gt_right">420</td>
<td headers="stub_1_31 median_umis" class="gt_row gt_right" style="background-color: #7AF000; color: #000000;">2,922.0</td>
<td headers="stub_1_31 median_features" class="gt_row gt_right">1,399.5</td>
</tr>
<tr>
<th id="stub_1_32" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_32 batch" class="gt_row gt_left">JD149A</td>
<td headers="stub_1_32 num_cells" class="gt_row gt_right">275</td>
<td headers="stub_1_32 median_umis" class="gt_row gt_right" style="background-color: #3DFB00; color: #000000;">1,118.0</td>
<td headers="stub_1_32 median_features" class="gt_row gt_right">699.0</td>
</tr>
<tr>
<th id="stub_1_33" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_33 batch" class="gt_row gt_left">JD149B</td>
<td headers="stub_1_33 num_cells" class="gt_row gt_right">251</td>
<td headers="stub_1_33 median_umis" class="gt_row gt_right" style="background-color: #2AFD00; color: #000000;">823.0</td>
<td headers="stub_1_33 median_features" class="gt_row gt_right">531.0</td>
</tr>
<tr>
<th id="stub_1_34" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_34 batch" class="gt_row gt_left">JD149C</td>
<td headers="stub_1_34 num_cells" class="gt_row gt_right">382</td>
<td headers="stub_1_34 median_umis" class="gt_row gt_right" style="background-color: #41FB00; color: #000000;">1,179.5</td>
<td headers="stub_1_34 median_features" class="gt_row gt_right">747.5</td>
</tr>
<tr>
<th id="stub_1_35" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_35 batch" class="gt_row gt_left">JD149D</td>
<td headers="stub_1_35 num_cells" class="gt_row gt_right">365</td>
<td headers="stub_1_35 median_umis" class="gt_row gt_right" style="background-color: #3AFC00; color: #000000;">1,054.0</td>
<td headers="stub_1_35 median_features" class="gt_row gt_right">688.0</td>
</tr>
<tr>
<th id="stub_1_36" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_36 batch" class="gt_row gt_left">JD149E</td>
<td headers="stub_1_36 num_cells" class="gt_row gt_right">236</td>
<td headers="stub_1_36 median_umis" class="gt_row gt_right" style="background-color: #2DFD00; color: #000000;">854.5</td>
<td headers="stub_1_36 median_features" class="gt_row gt_right">603.0</td>
</tr>
<tr>
<th id="stub_1_37" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_37 batch" class="gt_row gt_left">JD150-3A</td>
<td headers="stub_1_37 num_cells" class="gt_row gt_right">393</td>
<td headers="stub_1_37 median_umis" class="gt_row gt_right" style="background-color: #4EF900; color: #000000;">1,486.0</td>
<td headers="stub_1_37 median_features" class="gt_row gt_right">911.0</td>
</tr>
<tr>
<th id="stub_1_38" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_38 batch" class="gt_row gt_left">JD150-3B</td>
<td headers="stub_1_38 num_cells" class="gt_row gt_right">345</td>
<td headers="stub_1_38 median_umis" class="gt_row gt_right" style="background-color: #54F800; color: #000000;">1,624.0</td>
<td headers="stub_1_38 median_features" class="gt_row gt_right">1,002.0</td>
</tr>
<tr>
<th id="stub_1_39" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_39 batch" class="gt_row gt_left">JD150-3C</td>
<td headers="stub_1_39 num_cells" class="gt_row gt_right">487</td>
<td headers="stub_1_39 median_umis" class="gt_row gt_right" style="background-color: #64F500; color: #000000;">2,110.0</td>
<td headers="stub_1_39 median_features" class="gt_row gt_right">1,190.0</td>
</tr>
<tr>
<th id="stub_1_40" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_40 batch" class="gt_row gt_left">JD150-4A</td>
<td headers="stub_1_40 num_cells" class="gt_row gt_right">330</td>
<td headers="stub_1_40 median_umis" class="gt_row gt_right" style="background-color: #55F800; color: #000000;">1,652.0</td>
<td headers="stub_1_40 median_features" class="gt_row gt_right">962.0</td>
</tr>
<tr>
<th id="stub_1_41" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_41 batch" class="gt_row gt_left">JD150-4B</td>
<td headers="stub_1_41 num_cells" class="gt_row gt_right">370</td>
<td headers="stub_1_41 median_umis" class="gt_row gt_right" style="background-color: #4EF900; color: #000000;">1,476.5</td>
<td headers="stub_1_41 median_features" class="gt_row gt_right">893.5</td>
</tr>
<tr>
<th id="stub_1_42" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_42 batch" class="gt_row gt_left">JD150A</td>
<td headers="stub_1_42 num_cells" class="gt_row gt_right">342</td>
<td headers="stub_1_42 median_umis" class="gt_row gt_right" style="background-color: #26FD00; color: #000000;">778.5</td>
<td headers="stub_1_42 median_features" class="gt_row gt_right">487.0</td>
</tr>
<tr>
<th id="stub_1_43" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_43 batch" class="gt_row gt_left">JD150B</td>
<td headers="stub_1_43 num_cells" class="gt_row gt_right">317</td>
<td headers="stub_1_43 median_umis" class="gt_row gt_right" style="background-color: #2CFD00; color: #000000;">849.0</td>
<td headers="stub_1_43 median_features" class="gt_row gt_right">564.0</td>
</tr>
<tr>
<th id="stub_1_44" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_44 batch" class="gt_row gt_left">JD150C</td>
<td headers="stub_1_44 num_cells" class="gt_row gt_right">346</td>
<td headers="stub_1_44 median_umis" class="gt_row gt_right" style="background-color: #4AFA00; color: #000000;">1,372.0</td>
<td headers="stub_1_44 median_features" class="gt_row gt_right">888.5</td>
</tr>
<tr>
<th id="stub_1_45" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_45 batch" class="gt_row gt_left">JD150D</td>
<td headers="stub_1_45 num_cells" class="gt_row gt_right">465</td>
<td headers="stub_1_45 median_umis" class="gt_row gt_right" style="background-color: #3BFC00; color: #000000;">1,081.0</td>
<td headers="stub_1_45 median_features" class="gt_row gt_right">723.0</td>
</tr>
<tr>
<th id="stub_1_46" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_46 batch" class="gt_row gt_left">JD164_165</td>
<td headers="stub_1_46 num_cells" class="gt_row gt_right">272</td>
<td headers="stub_1_46 median_umis" class="gt_row gt_right" style="background-color: #83ED00; color: #000000;">3,324.5</td>
<td headers="stub_1_46 median_features" class="gt_row gt_right">1,935.5</td>
</tr>
<tr>
<th id="stub_1_47" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_47 batch" class="gt_row gt_left">JD166_167</td>
<td headers="stub_1_47 num_cells" class="gt_row gt_right">204</td>
<td headers="stub_1_47 median_umis" class="gt_row gt_right" style="background-color: #B6D900; color: #000000;">6,267.5</td>
<td headers="stub_1_47 median_features" class="gt_row gt_right">3,047.0</td>
</tr>
<tr>
<th id="stub_1_48" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_48 batch" class="gt_row gt_left">JD168A</td>
<td headers="stub_1_48 num_cells" class="gt_row gt_right">252</td>
<td headers="stub_1_48 median_umis" class="gt_row gt_right" style="background-color: #F6AD00; color: #000000;">11,674.5</td>
<td headers="stub_1_48 median_features" class="gt_row gt_right">4,225.0</td>
</tr>
<tr>
<th id="stub_1_49" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_49 batch" class="gt_row gt_left">JD168B</td>
<td headers="stub_1_49 num_cells" class="gt_row gt_right">240</td>
<td headers="stub_1_49 median_umis" class="gt_row gt_right" style="background-color: #A1E300; color: #000000;">4,899.5</td>
<td headers="stub_1_49 median_features" class="gt_row gt_right">2,510.5</td>
</tr>
<tr>
<th id="stub_1_50" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_50 batch" class="gt_row gt_left">JD168C</td>
<td headers="stub_1_50 num_cells" class="gt_row gt_right">182</td>
<td headers="stub_1_50 median_umis" class="gt_row gt_right" style="background-color: #FF9300; color: #000000;">14,665.5</td>
<td headers="stub_1_50 median_features" class="gt_row gt_right">4,678.5</td>
</tr>
<tr>
<th id="stub_1_51" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_51 batch" class="gt_row gt_left">JD168_169</td>
<td headers="stub_1_51 num_cells" class="gt_row gt_right">236</td>
<td headers="stub_1_51 median_umis" class="gt_row gt_right" style="background-color: #95E700; color: #000000;">4,234.5</td>
<td headers="stub_1_51 median_features" class="gt_row gt_right">2,302.5</td>
</tr>
<tr>
<th id="stub_1_52" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_52 batch" class="gt_row gt_left">JD169A</td>
<td headers="stub_1_52 num_cells" class="gt_row gt_right">306</td>
<td headers="stub_1_52 median_umis" class="gt_row gt_right" style="background-color: #CACE00; color: #000000;">7,700.0</td>
<td headers="stub_1_52 median_features" class="gt_row gt_right">3,450.0</td>
</tr>
<tr>
<th id="stub_1_53" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_53 batch" class="gt_row gt_left">JD169B</td>
<td headers="stub_1_53 num_cells" class="gt_row gt_right">178</td>
<td headers="stub_1_53 median_umis" class="gt_row gt_right" style="background-color: #FF9F00; color: #000000;">13,284.5</td>
<td headers="stub_1_53 median_features" class="gt_row gt_right">4,515.5</td>
</tr>
<tr>
<th id="stub_1_54" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_54 batch" class="gt_row gt_left">JD169C</td>
<td headers="stub_1_54 num_cells" class="gt_row gt_right">206</td>
<td headers="stub_1_54 median_umis" class="gt_row gt_right" style="background-color: #EFB400; color: #000000;">10,929.5</td>
<td headers="stub_1_54 median_features" class="gt_row gt_right">4,092.0</td>
</tr>
<tr>
<th id="stub_1_55" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_55 batch" class="gt_row gt_left">JD170A</td>
<td headers="stub_1_55 num_cells" class="gt_row gt_right">148</td>
<td headers="stub_1_55 median_umis" class="gt_row gt_right" style="background-color: #F1B200; color: #000000;">11,175.0</td>
<td headers="stub_1_55 median_features" class="gt_row gt_right">4,197.0</td>
</tr>
<tr>
<th id="stub_1_56" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_56 batch" class="gt_row gt_left">JD170B</td>
<td headers="stub_1_56 num_cells" class="gt_row gt_right">108</td>
<td headers="stub_1_56 median_umis" class="gt_row gt_right" style="background-color: #FDA700; color: #000000;">12,311.0</td>
<td headers="stub_1_56 median_features" class="gt_row gt_right">4,191.0</td>
</tr>
<tr>
<th id="stub_1_57" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_57 batch" class="gt_row gt_left">JD170C</td>
<td headers="stub_1_57 num_cells" class="gt_row gt_right">150</td>
<td headers="stub_1_57 median_umis" class="gt_row gt_right" style="background-color: #F9AB00; color: #000000;">11,961.5</td>
<td headers="stub_1_57 median_features" class="gt_row gt_right">4,228.0</td>
</tr>
<tr>
<th id="stub_1_58" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_58 batch" class="gt_row gt_left">JD170_171</td>
<td headers="stub_1_58 num_cells" class="gt_row gt_right">288</td>
<td headers="stub_1_58 median_umis" class="gt_row gt_right" style="background-color: #FF9C00; color: #000000;">13,620.5</td>
<td headers="stub_1_58 median_features" class="gt_row gt_right">4,505.5</td>
</tr>
<tr>
<th id="stub_1_59" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_59 batch" class="gt_row gt_left">JD171A</td>
<td headers="stub_1_59 num_cells" class="gt_row gt_right">270</td>
<td headers="stub_1_59 median_umis" class="gt_row gt_right" style="background-color: #C4D200; color: #000000;">7,281.0</td>
<td headers="stub_1_59 median_features" class="gt_row gt_right">3,207.0</td>
</tr>
<tr>
<th id="stub_1_60" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_60 batch" class="gt_row gt_left">JD171B</td>
<td headers="stub_1_60 num_cells" class="gt_row gt_right">224</td>
<td headers="stub_1_60 median_umis" class="gt_row gt_right" style="background-color: #F5AE00; color: #000000;">11,545.0</td>
<td headers="stub_1_60 median_features" class="gt_row gt_right">4,211.5</td>
</tr>
<tr>
<th id="stub_1_61" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_61 batch" class="gt_row gt_left">JD171C</td>
<td headers="stub_1_61 num_cells" class="gt_row gt_right">166</td>
<td headers="stub_1_61 median_umis" class="gt_row gt_right" style="background-color: #DDC200; color: #000000;">9,291.0</td>
<td headers="stub_1_61 median_features" class="gt_row gt_right">3,673.0</td>
</tr>
<tr>
<th id="stub_1_62" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_62 batch" class="gt_row gt_left">PZ473</td>
<td headers="stub_1_62 num_cells" class="gt_row gt_right">168</td>
<td headers="stub_1_62 median_umis" class="gt_row gt_right" style="background-color: #DEC100; color: #000000;">9,368.5</td>
<td headers="stub_1_62 median_features" class="gt_row gt_right">3,888.5</td>
</tr>
<tr>
<th id="stub_1_63" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_63 batch" class="gt_row gt_left">PZ474</td>
<td headers="stub_1_63 num_cells" class="gt_row gt_right">188</td>
<td headers="stub_1_63 median_umis" class="gt_row gt_right" style="background-color: #B9D800; color: #000000;">6,470.0</td>
<td headers="stub_1_63 median_features" class="gt_row gt_right">3,116.5</td>
</tr>
<tr>
<th id="stub_1_64" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_64 batch" class="gt_row gt_left">PZ475</td>
<td headers="stub_1_64 num_cells" class="gt_row gt_right">326</td>
<td headers="stub_1_64 median_umis" class="gt_row gt_right" style="background-color: #F5AF00; color: #000000;">11,516.5</td>
<td headers="stub_1_64 median_features" class="gt_row gt_right">4,077.0</td>
</tr>
<tr>
<th id="stub_1_65" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_65 batch" class="gt_row gt_left">PZ476</td>
<td headers="stub_1_65 num_cells" class="gt_row gt_right">292</td>
<td headers="stub_1_65 median_umis" class="gt_row gt_right" style="background-color: #E7BB00; color: #000000;">10,177.5</td>
<td headers="stub_1_65 median_features" class="gt_row gt_right">3,943.0</td>
</tr>
<tr>
<th id="stub_1_66" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_66 batch" class="gt_row gt_left">PZ477</td>
<td headers="stub_1_66 num_cells" class="gt_row gt_right">552</td>
<td headers="stub_1_66 median_umis" class="gt_row gt_right" style="background-color: #ACDE00; color: #000000;">5,562.5</td>
<td headers="stub_1_66 median_features" class="gt_row gt_right">2,731.0</td>
</tr>
<tr>
<th id="stub_1_67" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_67 batch" class="gt_row gt_left">PZ478</td>
<td headers="stub_1_67 num_cells" class="gt_row gt_right">344</td>
<td headers="stub_1_67 median_umis" class="gt_row gt_right" style="background-color: #C3D200; color: #000000;">7,171.0</td>
<td headers="stub_1_67 median_features" class="gt_row gt_right">3,283.5</td>
</tr>
<tr>
<th id="stub_1_68" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_68 batch" class="gt_row gt_left">PZ479</td>
<td headers="stub_1_68 num_cells" class="gt_row gt_right">356</td>
<td headers="stub_1_68 median_umis" class="gt_row gt_right" style="background-color: #DBC300; color: #000000;">9,106.0</td>
<td headers="stub_1_68 median_features" class="gt_row gt_right">3,655.0</td>
</tr>
<tr>
<th id="stub_1_69" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_69 batch" class="gt_row gt_left">PZ480</td>
<td headers="stub_1_69 num_cells" class="gt_row gt_right">196</td>
<td headers="stub_1_69 median_umis" class="gt_row gt_right" style="background-color: #E7BA00; color: #000000;">10,180.5</td>
<td headers="stub_1_69 median_features" class="gt_row gt_right">3,878.5</td>
</tr>
<tr>
<th id="stub_1_70" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_70 batch" class="gt_row gt_left">PZ481</td>
<td headers="stub_1_70 num_cells" class="gt_row gt_right">132</td>
<td headers="stub_1_70 median_umis" class="gt_row gt_right" style="background-color: #F8AB00; color: #000000;">11,876.5</td>
<td headers="stub_1_70 median_features" class="gt_row gt_right">4,161.0</td>
</tr>
<tr>
<th id="stub_1_71" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_71 batch" class="gt_row gt_left">PZ482</td>
<td headers="stub_1_71 num_cells" class="gt_row gt_right">70</td>
<td headers="stub_1_71 median_umis" class="gt_row gt_right" style="background-color: #96E700; color: #000000;">4,286.0</td>
<td headers="stub_1_71 median_features" class="gt_row gt_right">2,213.0</td>
</tr>
<tr>
<th id="stub_1_72" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_72 batch" class="gt_row gt_left">PZ483</td>
<td headers="stub_1_72 num_cells" class="gt_row gt_right">98</td>
<td headers="stub_1_72 median_umis" class="gt_row gt_right" style="background-color: #99E600; color: #000000;">4,452.5</td>
<td headers="stub_1_72 median_features" class="gt_row gt_right">2,233.5</td>
</tr>
<tr>
<th id="stub_1_73" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_73 batch" class="gt_row gt_left">PZ484</td>
<td headers="stub_1_73 num_cells" class="gt_row gt_right">224</td>
<td headers="stub_1_73 median_umis" class="gt_row gt_right" style="background-color: #E4BD00; color: #000000;">9,902.5</td>
<td headers="stub_1_73 median_features" class="gt_row gt_right">3,863.5</td>
</tr>
<tr>
<th id="stub_1_74" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_74 batch" class="gt_row gt_left">PZ485</td>
<td headers="stub_1_74 num_cells" class="gt_row gt_right">264</td>
<td headers="stub_1_74 median_umis" class="gt_row gt_right" style="background-color: #EAB800; color: #000000;">10,482.5</td>
<td headers="stub_1_74 median_features" class="gt_row gt_right">3,963.5</td>
</tr>
<tr>
<th id="stub_1_75" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_75 batch" class="gt_row gt_left">PZ486</td>
<td headers="stub_1_75 num_cells" class="gt_row gt_right">344</td>
<td headers="stub_1_75 median_umis" class="gt_row gt_right" style="background-color: #B6D900; color: #000000;">6,220.0</td>
<td headers="stub_1_75 median_features" class="gt_row gt_right">2,901.5</td>
</tr>
<tr>
<th id="stub_1_76" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_76 batch" class="gt_row gt_left">PZ487</td>
<td headers="stub_1_76 num_cells" class="gt_row gt_right">238</td>
<td headers="stub_1_76 median_umis" class="gt_row gt_right" style="background-color: #A7E000; color: #000000;">5,281.5</td>
<td headers="stub_1_76 median_features" class="gt_row gt_right">2,571.5</td>
</tr>
<tr>
<th id="stub_1_77" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_77 batch" class="gt_row gt_left">PZ492</td>
<td headers="stub_1_77 num_cells" class="gt_row gt_right">399</td>
<td headers="stub_1_77 median_umis" class="gt_row gt_right" style="background-color: #54F800; color: #000000;">1,618.0</td>
<td headers="stub_1_77 median_features" class="gt_row gt_right">960.0</td>
</tr>
<tr>
<th id="stub_1_78" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_78 batch" class="gt_row gt_left">PZ493</td>
<td headers="stub_1_78 num_cells" class="gt_row gt_right">241</td>
<td headers="stub_1_78 median_umis" class="gt_row gt_right" style="background-color: #4BFA00; color: #000000;">1,394.0</td>
<td headers="stub_1_78 median_features" class="gt_row gt_right">841.0</td>
</tr>
<tr>
<th id="stub_1_79" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_79 batch" class="gt_row gt_left">PZ496</td>
<td headers="stub_1_79 num_cells" class="gt_row gt_right">344</td>
<td headers="stub_1_79 median_umis" class="gt_row gt_right" style="background-color: #C1D400; color: #000000;">7,004.5</td>
<td headers="stub_1_79 median_features" class="gt_row gt_right">3,245.0</td>
</tr>
<tr>
<th id="stub_1_80" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_80 batch" class="gt_row gt_left">PZ497</td>
<td headers="stub_1_80 num_cells" class="gt_row gt_right">208</td>
<td headers="stub_1_80 median_umis" class="gt_row gt_right" style="background-color: #E0C000; color: #000000;">9,547.0</td>
<td headers="stub_1_80 median_features" class="gt_row gt_right">3,810.5</td>
</tr>
<tr>
<th id="stub_1_81" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_81 batch" class="gt_row gt_left">PZ580</td>
<td headers="stub_1_81 num_cells" class="gt_row gt_right">472</td>
<td headers="stub_1_81 median_umis" class="gt_row gt_right" style="background-color: #D0CB00; color: #000000;">8,199.5</td>
<td headers="stub_1_81 median_features" class="gt_row gt_right">3,482.5</td>
</tr>
<tr>
<th id="stub_1_82" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_82 batch" class="gt_row gt_left">PZ581</td>
<td headers="stub_1_82 num_cells" class="gt_row gt_right">360</td>
<td headers="stub_1_82 median_umis" class="gt_row gt_right" style="background-color: #B9D800; color: #000000;">6,468.0</td>
<td headers="stub_1_82 median_features" class="gt_row gt_right">3,058.5</td>
</tr>
<tr>
<th id="stub_1_83" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_83 batch" class="gt_row gt_left">PZ582</td>
<td headers="stub_1_83 num_cells" class="gt_row gt_right">214</td>
<td headers="stub_1_83 median_umis" class="gt_row gt_right" style="background-color: #E2BE00; color: #000000;">9,730.5</td>
<td headers="stub_1_83 median_features" class="gt_row gt_right">3,892.5</td>
</tr>
<tr>
<th id="stub_1_84" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_84 batch" class="gt_row gt_left">PZ583</td>
<td headers="stub_1_84 num_cells" class="gt_row gt_right">120</td>
<td headers="stub_1_84 median_umis" class="gt_row gt_right" style="background-color: #E6BC00; color: #000000;">10,060.5</td>
<td headers="stub_1_84 median_features" class="gt_row gt_right">3,977.0</td>
</tr>
<tr>
<th id="stub_1_85" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_85 batch" class="gt_row gt_left">PZ584</td>
<td headers="stub_1_85 num_cells" class="gt_row gt_right">190</td>
<td headers="stub_1_85 median_umis" class="gt_row gt_right" style="background-color: #FF9700; color: #000000;">14,141.5</td>
<td headers="stub_1_85 median_features" class="gt_row gt_right">4,915.0</td>
</tr>
<tr>
<th id="stub_1_86" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_86 batch" class="gt_row gt_left">PZ585</td>
<td headers="stub_1_86 num_cells" class="gt_row gt_right">152</td>
<td headers="stub_1_86 median_umis" class="gt_row gt_right" style="background-color: #FF8B00; color: #000000;">15,586.5</td>
<td headers="stub_1_86 median_features" class="gt_row gt_right">4,924.0</td>
</tr>
<tr>
<th id="stub_1_87" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_87 batch" class="gt_row gt_left">PZ586</td>
<td headers="stub_1_87 num_cells" class="gt_row gt_right">292</td>
<td headers="stub_1_87 median_umis" class="gt_row gt_right" style="background-color: #A1E300; color: #000000;">4,879.0</td>
<td headers="stub_1_87 median_features" class="gt_row gt_right">2,466.5</td>
</tr>
<tr>
<th id="stub_1_88" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_88 batch" class="gt_row gt_left">PZ587</td>
<td headers="stub_1_88 num_cells" class="gt_row gt_right">204</td>
<td headers="stub_1_88 median_umis" class="gt_row gt_right" style="background-color: #F9AA00; color: #000000;">11,968.5</td>
<td headers="stub_1_88 median_features" class="gt_row gt_right">4,318.5</td>
</tr>
<tr>
<th id="stub_1_89" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_89 batch" class="gt_row gt_left">PZ588</td>
<td headers="stub_1_89 num_cells" class="gt_row gt_right">110</td>
<td headers="stub_1_89 median_umis" class="gt_row gt_right" style="background-color: #FF0000; color: #FFFFFF;">24,547.5</td>
<td headers="stub_1_89 median_features" class="gt_row gt_right">5,941.0</td>
</tr>
<tr>
<th id="stub_1_90" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_90 batch" class="gt_row gt_left">PZ589</td>
<td headers="stub_1_90 num_cells" class="gt_row gt_right">110</td>
<td headers="stub_1_90 median_umis" class="gt_row gt_right" style="background-color: #F4AF00; color: #000000;">11,439.0</td>
<td headers="stub_1_90 median_features" class="gt_row gt_right">3,965.5</td>
</tr>
<tr>
<th id="stub_1_91" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_91 batch" class="gt_row gt_left">PZ590</td>
<td headers="stub_1_91 num_cells" class="gt_row gt_right">94</td>
<td headers="stub_1_91 median_umis" class="gt_row gt_right" style="background-color: #FF7B00; color: #FFFFFF;">17,243.5</td>
<td headers="stub_1_91 median_features" class="gt_row gt_right">5,124.5</td>
</tr>
<tr>
<th id="stub_1_92" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_92 batch" class="gt_row gt_left">PZ660</td>
<td headers="stub_1_92 num_cells" class="gt_row gt_right">148</td>
<td headers="stub_1_92 median_umis" class="gt_row gt_right" style="background-color: #79F000; color: #000000;">2,893.5</td>
<td headers="stub_1_92 median_features" class="gt_row gt_right">1,478.0</td>
</tr>
<tr>
<th id="stub_1_93" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_93 batch" class="gt_row gt_left">PZ661</td>
<td headers="stub_1_93 num_cells" class="gt_row gt_right">136</td>
<td headers="stub_1_93 median_umis" class="gt_row gt_right" style="background-color: #6DF300; color: #000000;">2,414.5</td>
<td headers="stub_1_93 median_features" class="gt_row gt_right">1,289.5</td>
</tr>
<tr>
<th id="grand_summary_stub_1" scope="row" class="gt_row gt_left gt_stub gt_grand_summary_row gt_first_grand_summary_row">Count</th>
<td headers="grand_summary_stub_1 batch" class="gt_row gt_left gt_grand_summary_row gt_first_grand_summary_row">93</td>
<td headers="grand_summary_stub_1 num_cells" class="gt_row gt_right gt_grand_summary_row gt_first_grand_summary_row"></td>
<td headers="grand_summary_stub_1 median_umis" class="gt_row gt_right gt_grand_summary_row gt_first_grand_summary_row"></td>
<td headers="grand_summary_stub_1 median_features" class="gt_row gt_right gt_grand_summary_row gt_first_grand_summary_row"></td>
</tr>
<tr>
<th id="grand_summary_stub_2" scope="row" class="gt_row gt_left gt_stub gt_grand_summary_row">Mean</th>
<td headers="grand_summary_stub_2 batch" class="gt_row gt_left gt_grand_summary_row"></td>
<td headers="grand_summary_stub_2 num_cells" class="gt_row gt_right gt_grand_summary_row">277.2</td>
<td headers="grand_summary_stub_2 median_umis" class="gt_row gt_right gt_grand_summary_row">5,734.1</td>
<td headers="grand_summary_stub_2 median_features" class="gt_row gt_right gt_grand_summary_row">2,348.6</td>
</tr>
<tr>
<th id="grand_summary_stub_3" scope="row" class="gt_row gt_left gt_stub gt_grand_summary_row gt_last_summary_row">Sum</th>
<td headers="grand_summary_stub_3 batch" class="gt_row gt_left gt_grand_summary_row gt_last_summary_row"></td>
<td headers="grand_summary_stub_3 num_cells" class="gt_row gt_right gt_grand_summary_row gt_last_summary_row">25,776</td>
<td headers="grand_summary_stub_3 median_umis" class="gt_row gt_right gt_grand_summary_row gt_last_summary_row"></td>
<td headers="grand_summary_stub_3 median_features" class="gt_row gt_right gt_grand_summary_row gt_last_summary_row"></td>
</tr>
</tbody>
<tfoot class="gt_sourcenotes"><tr>
<td class="gt_sourcenote" colspan="5"><em><strong><a href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE117795">Here</a></strong> are the details.</em></td>
    </tr></tfoot>
</table>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">embedding</span> <span class="op">&lt;-</span> <span class="va">embedding</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">rownames_to_column</a></span><span class="op">(</span>var <span class="op">=</span> <span class="st">"cell"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>        group <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span></span>
<span>            <span class="va">category</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"JD168"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Reprogrammed"</span>,</span>
<span>            <span class="va">category</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"JD174"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Control"</span>,</span>
<span>            <span class="cn">TRUE</span> <span class="op">~</span> <span class="st">"Primary"</span></span>
<span>        <span class="op">)</span>,</span>
<span>        group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span></span>
<span>            <span class="va">group</span>,</span>
<span>            levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Primary"</span>, <span class="st">"Reprogrammed"</span>, <span class="st">"Control"</span><span class="op">)</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p_embedding_cluster</span> <span class="op">&lt;-</span> <span class="fu">plot_embedding</span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">embedding</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">x_column</span>, <span class="va">y_column</span><span class="op">)</span><span class="op">]</span>,</span>
<span>    color <span class="op">=</span> <span class="va">embedding</span><span class="op">$</span><span class="va">cluster</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    label <span class="op">=</span> <span class="fu">glue</span><span class="fu">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html">glue</a></span><span class="op">(</span><span class="st">"{EMBEDDING_TITLE_PREFIX}; Cluster"</span><span class="op">)</span>,</span>
<span>    color_labels <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    color_legend <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    sort_values <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    rasterise <span class="op">=</span> <span class="va">RASTERISED</span>,</span>
<span>    geom_point_size <span class="op">=</span> <span class="va">GEOM_POINT_SIZE</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme_customized_embedding</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p_embedding_UMI</span> <span class="op">&lt;-</span> <span class="fu">plot_embedding</span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">embedding</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">x_column</span>, <span class="va">y_column</span><span class="op">)</span><span class="op">]</span>,</span>
<span>    color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="fu">Matrix</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/colSums.html">colSums</a></span><span class="op">(</span><span class="va">matrix_readcount_use</span><span class="op">[</span>, <span class="va">embedding</span><span class="op">$</span><span class="va">cell</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    label <span class="op">=</span> <span class="fu">glue</span><span class="fu">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html">glue</a></span><span class="op">(</span><span class="st">"{EMBEDDING_TITLE_PREFIX}; UMI"</span><span class="op">)</span>,</span>
<span>    color_legend <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    sort_values <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    shuffle_values <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    rasterise <span class="op">=</span> <span class="va">RASTERISED</span>,</span>
<span>    geom_point_size <span class="op">=</span> <span class="va">GEOM_POINT_SIZE</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme_customized_embedding</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p_embedding_MT</span> <span class="op">&lt;-</span> <span class="fu">plot_embedding</span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">embedding</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">x_column</span>, <span class="va">y_column</span><span class="op">)</span><span class="op">]</span>,</span>
<span>    color <span class="op">=</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/colSums.html">colSums</a></span><span class="op">(</span><span class="va">matrix_readcount_use</span><span class="op">[</span></span>
<span>        <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span></span>
<span>            string <span class="op">=</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_remove.html">str_remove</a></span><span class="op">(</span></span>
<span>                string <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">matrix_readcount_use</span><span class="op">)</span>,</span>
<span>                pattern <span class="op">=</span> <span class="st">"^E.+_"</span></span>
<span>            <span class="op">)</span>,</span>
<span>            pattern <span class="op">=</span> <span class="st">"mt-"</span></span>
<span>        <span class="op">)</span>,</span>
<span>    <span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/colSums.html">colSums</a></span><span class="op">(</span><span class="va">matrix_readcount_use</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="va">embedding</span><span class="op">$</span><span class="va">cell</span><span class="op">]</span>,</span>
<span>    label <span class="op">=</span> <span class="fu">glue</span><span class="fu">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html">glue</a></span><span class="op">(</span><span class="st">"{EMBEDDING_TITLE_PREFIX}; MT %"</span><span class="op">)</span>,</span>
<span>    color_legend <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    sort_values <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    shuffle_values <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    rasterise <span class="op">=</span> <span class="va">RASTERISED</span>,</span>
<span>    geom_point_size <span class="op">=</span> <span class="va">GEOM_POINT_SIZE</span></span>
<span><span class="op">)</span> <span class="op">+</span> <span class="fu">theme_customized_embedding</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p_embedding_group</span> <span class="op">&lt;-</span> <span class="fu">plot_embedding</span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">embedding</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">x_column</span>, <span class="va">y_column</span><span class="op">)</span><span class="op">]</span>,</span>
<span>    color <span class="op">=</span> <span class="va">embedding</span><span class="op">$</span><span class="va">group</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    label <span class="op">=</span> <span class="fu">glue</span><span class="fu">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html">glue</a></span><span class="op">(</span><span class="st">"{EMBEDDING_TITLE_PREFIX}; Group"</span><span class="op">)</span>,</span>
<span>    color_labels <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    color_legend <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    sort_values <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    shuffle_values <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    rasterise <span class="op">=</span> <span class="va">RASTERISED</span>,</span>
<span>    geom_point_size <span class="op">=</span> <span class="va">GEOM_POINT_SIZE</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme_customized_embedding</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span></span>
<span>        values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>            Primary <span class="op">=</span> <span class="st">"#00AFBB"</span>,</span>
<span>            Reprogrammed <span class="op">=</span> <span class="st">"#8BC34A"</span>,</span>
<span>            Control <span class="op">=</span> <span class="st">"#E7B800"</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">embedding</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>        num_umis <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/colSums.html">colSums</a></span><span class="op">(</span><span class="va">matrix_readcount_use</span><span class="op">[</span>, <span class="va">cell</span><span class="op">]</span><span class="op">)</span>,</span>
<span>        num_features <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/colSums.html">colSums</a></span><span class="op">(</span><span class="va">matrix_readcount_use</span><span class="op">[</span>, <span class="va">cell</span><span class="op">]</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">cluster</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span></span>
<span>        num_cells <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        median_umis <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">num_umis</span><span class="op">)</span>,</span>
<span>        median_features <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">num_features</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/gt.html">gt</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/data_color.html">data_color</a></span><span class="op">(</span></span>
<span>        columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">median_umis</span><span class="op">)</span>,</span>
<span>        fn <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/col_numeric.html">col_numeric</a></span><span class="op">(</span></span>
<span>            palette <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>                <span class="st">"green"</span>, <span class="st">"orange"</span>, <span class="st">"red"</span></span>
<span>            <span class="op">)</span>,</span>
<span>            domain <span class="op">=</span> <span class="cn">NULL</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/fmt_number.html">fmt_number</a></span><span class="op">(</span></span>
<span>        columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">num_cells</span><span class="op">)</span>,</span>
<span>        sep_mark <span class="op">=</span> <span class="st">","</span>,</span>
<span>        decimals <span class="op">=</span> <span class="fl">0</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/fmt_number.html">fmt_number</a></span><span class="op">(</span></span>
<span>        columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">median_umis</span>, <span class="va">median_features</span><span class="op">)</span>,</span>
<span>        sep_mark <span class="op">=</span> <span class="st">","</span>,</span>
<span>        decimals <span class="op">=</span> <span class="fl">1</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/grand_summary_rows.html">grand_summary_rows</a></span><span class="op">(</span></span>
<span>        columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">cluster</span><span class="op">)</span>,</span>
<span>        fns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>            Count <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span></span>
<span>        <span class="op">)</span>,</span>
<span>        fmt <span class="op">=</span> <span class="op">~</span> <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/fmt_number.html">fmt_number</a></span><span class="op">(</span><span class="va">.</span>, decimals <span class="op">=</span> <span class="fl">0</span>, use_seps <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/grand_summary_rows.html">grand_summary_rows</a></span><span class="op">(</span></span>
<span>        columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">median_umis</span><span class="op">:</span><span class="va">median_features</span><span class="op">)</span>,</span>
<span>        fns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>            Mean <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span></span>
<span>        <span class="op">)</span>,</span>
<span>        fmt <span class="op">=</span> <span class="op">~</span> <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/fmt_number.html">fmt_number</a></span><span class="op">(</span><span class="va">.</span>, decimals <span class="op">=</span> <span class="fl">1</span>, use_seps <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/grand_summary_rows.html">grand_summary_rows</a></span><span class="op">(</span></span>
<span>        columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">num_cells</span><span class="op">)</span>,</span>
<span>        fns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>            Sum <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span></span>
<span>        <span class="op">)</span>,</span>
<span>        fmt <span class="op">=</span> <span class="op">~</span> <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/fmt_number.html">fmt_number</a></span><span class="op">(</span><span class="va">.</span>, decimals <span class="op">=</span> <span class="fl">0</span>, use_seps <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/tab_header.html">tab_header</a></span><span class="op">(</span></span>
<span>        title <span class="op">=</span> <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/md.html">md</a></span><span class="op">(</span><span class="st">"**Drop-Seq**; Clustering"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="pbapkoazqy" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#pbapkoazqy thead, #pbapkoazqy tbody, #pbapkoazqy tfoot, #pbapkoazqy tr, #pbapkoazqy td, #pbapkoazqy th {
  border-style: none;
}

#pbapkoazqy p {
  margin: 0;
  padding: 0;
}

#pbapkoazqy .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#pbapkoazqy .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#pbapkoazqy .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#pbapkoazqy .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#pbapkoazqy .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#pbapkoazqy .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pbapkoazqy .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#pbapkoazqy .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#pbapkoazqy .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#pbapkoazqy .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#pbapkoazqy .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#pbapkoazqy .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#pbapkoazqy .gt_spanner_row {
  border-bottom-style: hidden;
}

#pbapkoazqy .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#pbapkoazqy .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#pbapkoazqy .gt_from_md > :first-child {
  margin-top: 0;
}

#pbapkoazqy .gt_from_md > :last-child {
  margin-bottom: 0;
}

#pbapkoazqy .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#pbapkoazqy .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#pbapkoazqy .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#pbapkoazqy .gt_row_group_first td {
  border-top-width: 2px;
}

#pbapkoazqy .gt_row_group_first th {
  border-top-width: 2px;
}

#pbapkoazqy .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#pbapkoazqy .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#pbapkoazqy .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#pbapkoazqy .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pbapkoazqy .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#pbapkoazqy .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#pbapkoazqy .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#pbapkoazqy .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#pbapkoazqy .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pbapkoazqy .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#pbapkoazqy .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#pbapkoazqy .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#pbapkoazqy .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#pbapkoazqy .gt_left {
  text-align: left;
}

#pbapkoazqy .gt_center {
  text-align: center;
}

#pbapkoazqy .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#pbapkoazqy .gt_font_normal {
  font-weight: normal;
}

#pbapkoazqy .gt_font_bold {
  font-weight: bold;
}

#pbapkoazqy .gt_font_italic {
  font-style: italic;
}

#pbapkoazqy .gt_super {
  font-size: 65%;
}

#pbapkoazqy .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#pbapkoazqy .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#pbapkoazqy .gt_indent_1 {
  text-indent: 5px;
}

#pbapkoazqy .gt_indent_2 {
  text-indent: 10px;
}

#pbapkoazqy .gt_indent_3 {
  text-indent: 15px;
}

#pbapkoazqy .gt_indent_4 {
  text-indent: 20px;
}

#pbapkoazqy .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading">
<td colspan="5" class="gt_heading gt_title gt_font_normal gt_bottom_border" style="">
<strong>Drop-Seq</strong>; Clustering</td>
    </tr>
<tr class="gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id=""></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="cluster">cluster</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="num_cells">num_cells</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="median_umis">median_umis</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="median_features">median_features</th>
    </tr>
</thead>
<tbody class="gt_table_body">
<tr>
<th id="stub_1_1" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_1 cluster" class="gt_row gt_center">1</td>
<td headers="stub_1_1 num_cells" class="gt_row gt_right">2,875</td>
<td headers="stub_1_1 median_umis" class="gt_row gt_right" style="background-color: #FF0000; color: #FFFFFF;">13,196.0</td>
<td headers="stub_1_1 median_features" class="gt_row gt_right">4,578.0</td>
</tr>
<tr>
<th id="stub_1_2" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_2 cluster" class="gt_row gt_center">2</td>
<td headers="stub_1_2 num_cells" class="gt_row gt_right">2,798</td>
<td headers="stub_1_2 median_umis" class="gt_row gt_right" style="background-color: #FF8900; color: #000000;">8,594.0</td>
<td headers="stub_1_2 median_features" class="gt_row gt_right">3,639.5</td>
</tr>
<tr>
<th id="stub_1_3" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_3 cluster" class="gt_row gt_center">3</td>
<td headers="stub_1_3 num_cells" class="gt_row gt_right">2,786</td>
<td headers="stub_1_3 median_umis" class="gt_row gt_right" style="background-color: #F1B200; color: #000000;">6,165.0</td>
<td headers="stub_1_3 median_features" class="gt_row gt_right">2,905.0</td>
</tr>
<tr>
<th id="stub_1_4" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_4 cluster" class="gt_row gt_center">4</td>
<td headers="stub_1_4 num_cells" class="gt_row gt_right">2,710</td>
<td headers="stub_1_4 median_umis" class="gt_row gt_right" style="background-color: #3EFB00; color: #000000;">933.0</td>
<td headers="stub_1_4 median_features" class="gt_row gt_right">561.5</td>
</tr>
<tr>
<th id="stub_1_5" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_5 cluster" class="gt_row gt_center">5</td>
<td headers="stub_1_5 num_cells" class="gt_row gt_right">2,356</td>
<td headers="stub_1_5 median_umis" class="gt_row gt_right" style="background-color: #67F400; color: #000000;">1,505.5</td>
<td headers="stub_1_5 median_features" class="gt_row gt_right">1,013.0</td>
</tr>
<tr>
<th id="stub_1_6" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_6 cluster" class="gt_row gt_center">6</td>
<td headers="stub_1_6 num_cells" class="gt_row gt_right">2,139</td>
<td headers="stub_1_6 median_umis" class="gt_row gt_right" style="background-color: #96E700; color: #000000;">2,590.0</td>
<td headers="stub_1_6 median_features" class="gt_row gt_right">1,249.0</td>
</tr>
<tr>
<th id="stub_1_7" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_7 cluster" class="gt_row gt_center">7</td>
<td headers="stub_1_7 num_cells" class="gt_row gt_right">1,934</td>
<td headers="stub_1_7 median_umis" class="gt_row gt_right" style="background-color: #89EB00; color: #000000;">2,238.5</td>
<td headers="stub_1_7 median_features" class="gt_row gt_right">1,347.0</td>
</tr>
<tr>
<th id="stub_1_8" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_8 cluster" class="gt_row gt_center">8</td>
<td headers="stub_1_8 num_cells" class="gt_row gt_right">1,575</td>
<td headers="stub_1_8 median_umis" class="gt_row gt_right" style="background-color: #DDC200; color: #000000;">5,225.0</td>
<td headers="stub_1_8 median_features" class="gt_row gt_right">1,891.0</td>
</tr>
<tr>
<th id="stub_1_9" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_9 cluster" class="gt_row gt_center">9</td>
<td headers="stub_1_9 num_cells" class="gt_row gt_right">1,075</td>
<td headers="stub_1_9 median_umis" class="gt_row gt_right" style="background-color: #E8BA00; color: #000000;">5,719.0</td>
<td headers="stub_1_9 median_features" class="gt_row gt_right">2,203.0</td>
</tr>
<tr>
<th id="stub_1_10" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_10 cluster" class="gt_row gt_center">10</td>
<td headers="stub_1_10 num_cells" class="gt_row gt_right">871</td>
<td headers="stub_1_10 median_umis" class="gt_row gt_right" style="background-color: #FF1A00; color: #FFFFFF;">12,955.0</td>
<td headers="stub_1_10 median_features" class="gt_row gt_right">4,294.0</td>
</tr>
<tr>
<th id="stub_1_11" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_11 cluster" class="gt_row gt_center">11</td>
<td headers="stub_1_11 num_cells" class="gt_row gt_right">708</td>
<td headers="stub_1_11 median_umis" class="gt_row gt_right" style="background-color: #C3D200; color: #000000;">4,111.0</td>
<td headers="stub_1_11 median_features" class="gt_row gt_right">1,872.5</td>
</tr>
<tr>
<th id="stub_1_12" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_12 cluster" class="gt_row gt_center">12</td>
<td headers="stub_1_12 num_cells" class="gt_row gt_right">681</td>
<td headers="stub_1_12 median_umis" class="gt_row gt_right" style="background-color: #B3DB00; color: #000000;">3,495.0</td>
<td headers="stub_1_12 median_features" class="gt_row gt_right">1,956.0</td>
</tr>
<tr>
<th id="stub_1_13" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_13 cluster" class="gt_row gt_center">13</td>
<td headers="stub_1_13 num_cells" class="gt_row gt_right">669</td>
<td headers="stub_1_13 median_umis" class="gt_row gt_right" style="background-color: #91E900; color: #000000;">2,438.0</td>
<td headers="stub_1_13 median_features" class="gt_row gt_right">1,483.0</td>
</tr>
<tr>
<th id="stub_1_14" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_14 cluster" class="gt_row gt_center">14</td>
<td headers="stub_1_14 num_cells" class="gt_row gt_right">556</td>
<td headers="stub_1_14 median_umis" class="gt_row gt_right" style="background-color: #22FE00; color: #000000;">725.0</td>
<td headers="stub_1_14 median_features" class="gt_row gt_right">530.5</td>
</tr>
<tr>
<th id="stub_1_15" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_15 cluster" class="gt_row gt_center">15</td>
<td headers="stub_1_15 num_cells" class="gt_row gt_right">478</td>
<td headers="stub_1_15 median_umis" class="gt_row gt_right" style="background-color: #99E600; color: #000000;">2,661.0</td>
<td headers="stub_1_15 median_features" class="gt_row gt_right">1,606.5</td>
</tr>
<tr>
<th id="stub_1_16" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_16 cluster" class="gt_row gt_center">16</td>
<td headers="stub_1_16 num_cells" class="gt_row gt_right">474</td>
<td headers="stub_1_16 median_umis" class="gt_row gt_right" style="background-color: #5FF600; color: #000000;">1,368.0</td>
<td headers="stub_1_16 median_features" class="gt_row gt_right">906.5</td>
</tr>
<tr>
<th id="stub_1_17" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_17 cluster" class="gt_row gt_center">17</td>
<td headers="stub_1_17 num_cells" class="gt_row gt_right">254</td>
<td headers="stub_1_17 median_umis" class="gt_row gt_right" style="background-color: #D8C500; color: #000000;">4,995.5</td>
<td headers="stub_1_17 median_features" class="gt_row gt_right">2,172.5</td>
</tr>
<tr>
<th id="stub_1_18" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_18 cluster" class="gt_row gt_center">18</td>
<td headers="stub_1_18 num_cells" class="gt_row gt_right">236</td>
<td headers="stub_1_18 median_umis" class="gt_row gt_right" style="background-color: #73F200; color: #000000;">1,737.0</td>
<td headers="stub_1_18 median_features" class="gt_row gt_right">256.5</td>
</tr>
<tr>
<th id="stub_1_19" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_19 cluster" class="gt_row gt_center">19</td>
<td headers="stub_1_19 num_cells" class="gt_row gt_right">181</td>
<td headers="stub_1_19 median_umis" class="gt_row gt_right" style="background-color: #00FF00; color: #000000;">620.0</td>
<td headers="stub_1_19 median_features" class="gt_row gt_right">372.0</td>
</tr>
<tr>
<th id="stub_1_20" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_20 cluster" class="gt_row gt_center">20</td>
<td headers="stub_1_20 num_cells" class="gt_row gt_right">165</td>
<td headers="stub_1_20 median_umis" class="gt_row gt_right" style="background-color: #FF7900; color: #FFFFFF;">9,490.0</td>
<td headers="stub_1_20 median_features" class="gt_row gt_right">3,679.0</td>
</tr>
<tr>
<th id="stub_1_21" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_21 cluster" class="gt_row gt_center">21</td>
<td headers="stub_1_21 num_cells" class="gt_row gt_right">133</td>
<td headers="stub_1_21 median_umis" class="gt_row gt_right" style="background-color: #DEC100; color: #000000;">5,234.0</td>
<td headers="stub_1_21 median_features" class="gt_row gt_right">2,464.0</td>
</tr>
<tr>
<th id="stub_1_22" scope="row" class="gt_row gt_left gt_stub"></th>
<td headers="stub_1_22 cluster" class="gt_row gt_center">22</td>
<td headers="stub_1_22 num_cells" class="gt_row gt_right">122</td>
<td headers="stub_1_22 median_umis" class="gt_row gt_right" style="background-color: #F3B000; color: #000000;">6,274.0</td>
<td headers="stub_1_22 median_features" class="gt_row gt_right">2,877.0</td>
</tr>
<tr>
<th id="grand_summary_stub_1" scope="row" class="gt_row gt_left gt_stub gt_grand_summary_row gt_first_grand_summary_row">Count</th>
<td headers="grand_summary_stub_1 cluster" class="gt_row gt_center gt_grand_summary_row gt_first_grand_summary_row">22</td>
<td headers="grand_summary_stub_1 num_cells" class="gt_row gt_right gt_grand_summary_row gt_first_grand_summary_row"></td>
<td headers="grand_summary_stub_1 median_umis" class="gt_row gt_right gt_grand_summary_row gt_first_grand_summary_row"></td>
<td headers="grand_summary_stub_1 median_features" class="gt_row gt_right gt_grand_summary_row gt_first_grand_summary_row"></td>
</tr>
<tr>
<th id="grand_summary_stub_2" scope="row" class="gt_row gt_left gt_stub gt_grand_summary_row">Mean</th>
<td headers="grand_summary_stub_2 cluster" class="gt_row gt_center gt_grand_summary_row"></td>
<td headers="grand_summary_stub_2 num_cells" class="gt_row gt_right gt_grand_summary_row"></td>
<td headers="grand_summary_stub_2 median_umis" class="gt_row gt_right gt_grand_summary_row">4,648.6</td>
<td headers="grand_summary_stub_2 median_features" class="gt_row gt_right gt_grand_summary_row">1,993.5</td>
</tr>
<tr>
<th id="grand_summary_stub_3" scope="row" class="gt_row gt_left gt_stub gt_grand_summary_row gt_last_summary_row">Sum</th>
<td headers="grand_summary_stub_3 cluster" class="gt_row gt_center gt_grand_summary_row gt_last_summary_row"></td>
<td headers="grand_summary_stub_3 num_cells" class="gt_row gt_right gt_grand_summary_row gt_last_summary_row">25,776</td>
<td headers="grand_summary_stub_3 median_umis" class="gt_row gt_right gt_grand_summary_row gt_last_summary_row"></td>
<td headers="grand_summary_stub_3 median_features" class="gt_row gt_right gt_grand_summary_row gt_last_summary_row"></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/reduce.html">reduce</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>        <span class="va">p_embedding_cluster</span>,</span>
<span>        <span class="va">p_embedding_UMI</span>,</span>
<span>        <span class="va">p_embedding_MT</span>,</span>
<span>        <span class="va">p_embedding_group</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="va">`+`</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">patchwork</span><span class="fu">::</span><span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html">plot_layout</a></span><span class="op">(</span>ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">patchwork</span><span class="fu">::</span><span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_annotation.html">plot_annotation</a></span><span class="op">(</span></span>
<span>        theme <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>plot.margin <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">margin</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="unbiased_reprogramming_files/figure-html/unnamed-chunk-28-1.png" style="width:90.0%;height:90.0%" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://renkun-ken.github.io/formattable/">formattable</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'formattable'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:patchwork':

    area</code></pre>
</div>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">embedding</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>        num_umis <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/colSums.html">colSums</a></span><span class="op">(</span><span class="va">matrix_readcount_use</span><span class="op">[</span>, <span class="va">cell</span><span class="op">]</span><span class="op">)</span>,</span>
<span>        num_features <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/colSums.html">colSums</a></span><span class="op">(</span><span class="va">matrix_readcount_use</span><span class="op">[</span>, <span class="va">cell</span><span class="op">]</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">group</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span></span>
<span>        num_cells <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        median_umis <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">num_umis</span><span class="op">)</span>,</span>
<span>        median_features <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">num_features</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">formattable</span><span class="fu">::</span><span class="fu"><a href="https://renkun-ken.github.io/formattable/reference/formattable.html">formattable</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>            <span class="co"># num_cells = formattable::color_tile("transparent", "lightpink"),</span></span>
<span>            num_cells <span class="op">=</span> <span class="fu">formattable</span><span class="fu">::</span><span class="fu"><a href="https://renkun-ken.github.io/formattable/reference/color_bar.html">color_bar</a></span><span class="op">(</span><span class="st">"Lightpink"</span><span class="op">)</span>,</span>
<span>            median_umis <span class="op">=</span> <span class="fu">formattable</span><span class="fu">::</span><span class="fu"><a href="https://renkun-ken.github.io/formattable/reference/color_bar.html">color_bar</a></span><span class="op">(</span><span class="st">"lightgreen"</span><span class="op">)</span>,</span>
<span>            median_features <span class="op">=</span> <span class="fu">formattable</span><span class="fu">::</span><span class="fu"><a href="https://renkun-ken.github.io/formattable/reference/color_bar.html">color_bar</a></span><span class="op">(</span><span class="st">"lightblue"</span><span class="op">)</span></span>
<span>        <span class="op">)</span>,</span>
<span>        full_width <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>        caption <span class="op">=</span> <span class="st">"Drop-Seq; Group"</span></span>
<span>    <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="table table-condensed">
<caption>
Drop-Seq; Group
</caption>
<thead><tr>
<th style="text-align:right;">
group
</th>
<th style="text-align:right;">
num_cells
</th>
<th style="text-align:right;">
median_umis
</th>
<th style="text-align:right;">
median_features
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
Primary
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; unicode-bidi: plaintext; border-radius: 4px; padding-right: 2px; background-color: Lightpink; width: 100.00%">15684</span>
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; unicode-bidi: plaintext; border-radius: 4px; padding-right: 2px; background-color: lightgreen; width: 21.63%">2030</span>
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; unicode-bidi: plaintext; border-radius: 4px; padding-right: 2px; background-color: lightblue; width: 30.06%">1139</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
Reprogrammed
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; unicode-bidi: plaintext; border-radius: 4px; padding-right: 2px; background-color: Lightpink; width: 55.66%">8730</span>
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; unicode-bidi: plaintext; border-radius: 4px; padding-right: 2px; background-color: lightgreen; width: 90.93%">8532</span>
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; unicode-bidi: plaintext; border-radius: 4px; padding-right: 2px; background-color: lightblue; width: 94.01%">3562</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
Control
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; unicode-bidi: plaintext; border-radius: 4px; padding-right: 2px; background-color: Lightpink; width: 8.68%">1362</span>
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; unicode-bidi: plaintext; border-radius: 4px; padding-right: 2px; background-color: lightgreen; width: 100.00%">9383</span>
</td>
<td style="text-align:right;">
<span style="display: inline-block; direction: rtl; unicode-bidi: plaintext; border-radius: 4px; padding-right: 2px; background-color: lightblue; width: 100.00%">3789</span>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## | column: body-outset</span></span>
<span></span>
<span><span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">embedding</span><span class="op">$</span><span class="va">group</span><span class="op">)</span>, \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu">plot_embedding</span><span class="op">(</span></span>
<span>        data <span class="op">=</span> <span class="va">embedding</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">x_column</span>, <span class="va">y_column</span><span class="op">)</span><span class="op">]</span>,</span>
<span>        color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span><span class="op">(</span><span class="va">embedding</span><span class="op">$</span><span class="va">group</span> <span class="op">==</span> <span class="va">x</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        label <span class="op">=</span> <span class="fu">glue</span><span class="fu">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html">glue</a></span><span class="op">(</span></span>
<span>            <span class="st">"{EMBEDDING_TITLE_PREFIX}; {x}: {sum(embedding$group == x)}"</span></span>
<span>        <span class="op">)</span>,</span>
<span>        color_labels <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>        color_legend <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>        sort_values <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>        shuffle_values <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>        rasterise <span class="op">=</span> <span class="va">RASTERISED</span>,</span>
<span>        geom_point_size <span class="op">=</span> <span class="va">GEOM_POINT_SIZE</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu">theme_customized_embedding</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span></span>
<span>            values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"grey70"</span>, <span class="st">"salmon"</span><span class="op">)</span></span>
<span>        <span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/reduce.html">reduce</a></span><span class="op">(</span><span class="va">`+`</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">patchwork</span><span class="fu">::</span><span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html">plot_layout</a></span><span class="op">(</span>ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">patchwork</span><span class="fu">::</span><span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_annotation.html">plot_annotation</a></span><span class="op">(</span></span>
<span>        theme <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>plot.margin <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">margin</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display column-page">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="unbiased_reprogramming_files/figure-html/unnamed-chunk-31-1.png" style="width:81.5%;height:81.5%" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Extract colors from the initial plots to keep colors consistent.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">color_palette</span> <span class="op">&lt;-</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot_build.html">ggplot_build</a></span><span class="op">(</span><span class="va">p_embedding_cluster</span><span class="op">)</span><span class="op">$</span><span class="va">data</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">colour</span>, cluster <span class="op">=</span> <span class="va">group</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">cluster</span><span class="op">)</span></span>
<span></span>
<span><span class="va">color_palette</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html">setNames</a></span><span class="op">(</span></span>
<span>    object <span class="op">=</span> <span class="va">color_palette</span><span class="op">$</span><span class="va">color</span>,</span>
<span>    nm <span class="op">=</span> <span class="va">color_palette</span><span class="op">$</span><span class="va">cluster</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/show_col.html">show_col</a></span><span class="op">(</span><span class="va">color_palette</span>, borders <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="unbiased_reprogramming_files/figure-html/unnamed-chunk-32-1.png" style="width:50.0%;height:50.0%" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cell_type_segments</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>        <span class="op">-</span><span class="fl">40</span>, <span class="op">-</span><span class="fl">40</span>, <span class="op">-</span><span class="fl">40</span>, <span class="op">-</span><span class="fl">40</span>, <span class="op">-</span><span class="fl">69</span>, <span class="op">-</span><span class="fl">35</span>, <span class="fl">40</span>, <span class="fl">40</span>, <span class="fl">40</span>, <span class="fl">65</span>, <span class="fl">28</span>, <span class="op">-</span><span class="fl">12</span>, <span class="op">-</span><span class="fl">57.5</span>,</span>
<span>        <span class="op">-</span><span class="fl">57.5</span>, <span class="op">-</span><span class="fl">57.5</span></span>
<span>    <span class="op">)</span>,</span>
<span>    y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>        <span class="fl">60</span>, <span class="fl">60</span>, <span class="fl">60</span>, <span class="fl">60</span>, <span class="fl">20</span>, <span class="op">-</span><span class="fl">55</span>, <span class="op">-</span><span class="fl">70</span>, <span class="op">-</span><span class="fl">70</span>, <span class="op">-</span><span class="fl">70</span>, <span class="fl">50</span>, <span class="fl">55</span>, <span class="fl">65</span>, <span class="op">-</span><span class="fl">52.5</span>,</span>
<span>        <span class="op">-</span><span class="fl">52.5</span>, <span class="op">-</span><span class="fl">52.5</span></span>
<span>    <span class="op">)</span>,</span>
<span>    xend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>        <span class="op">-</span><span class="fl">30</span>, <span class="op">-</span><span class="fl">44</span>, <span class="op">-</span><span class="fl">60</span>, <span class="op">-</span><span class="fl">30</span>, <span class="op">-</span><span class="fl">69</span>, <span class="op">-</span><span class="fl">35</span>, <span class="fl">32</span>, <span class="fl">0</span>, <span class="fl">40</span>, <span class="fl">65</span>, <span class="fl">35</span>, <span class="op">-</span><span class="fl">20</span>, <span class="op">-</span><span class="fl">17.5</span>,</span>
<span>        <span class="op">-</span><span class="fl">53</span>, <span class="op">-</span><span class="fl">37.5</span></span>
<span>    <span class="op">)</span>,</span>
<span>    yend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>        <span class="fl">35</span>, <span class="fl">15</span>, <span class="op">-</span><span class="fl">5</span>, <span class="op">-</span><span class="fl">22</span>, <span class="fl">35</span>, <span class="op">-</span><span class="fl">65</span>, <span class="op">-</span><span class="fl">58</span>, <span class="op">-</span><span class="fl">66</span>, <span class="op">-</span><span class="fl">45</span>, <span class="fl">36</span>, <span class="fl">60</span>, <span class="fl">70</span>, <span class="op">-</span><span class="fl">25</span>,</span>
<span>        <span class="op">-</span><span class="fl">45</span>, <span class="op">-</span><span class="fl">47.5</span></span>
<span>    <span class="op">)</span>,</span>
<span>    cluster <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">6</span>, <span class="fl">9</span>, <span class="fl">11</span>, <span class="fl">8</span>, <span class="fl">12</span>, <span class="fl">7</span>, <span class="fl">13</span>, <span class="fl">14</span>, <span class="fl">16</span>, <span class="fl">5</span>, <span class="fl">15</span>, <span class="fl">2</span>, <span class="fl">20</span>, <span class="fl">12</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">cell_type_labels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">40</span>, <span class="op">-</span><span class="fl">61.5</span>, <span class="op">-</span><span class="fl">43</span>, <span class="fl">52</span>, <span class="fl">56</span>, <span class="fl">46</span>, <span class="op">-</span><span class="fl">22</span>, <span class="op">-</span><span class="fl">58</span><span class="op">)</span>,</span>
<span>    y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">65</span>, <span class="fl">45</span>, <span class="op">-</span><span class="fl">70</span>, <span class="op">-</span><span class="fl">70</span>, <span class="fl">55</span>, <span class="fl">64</span>, <span class="fl">75</span>, <span class="op">-</span><span class="fl">58</span><span class="op">)</span>,</span>
<span>    label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>        <span class="st">"Atrial myocytes"</span>,</span>
<span>        <span class="st">"Ventricular\nmyocytes"</span>,</span>
<span>        <span class="st">"Epicardial cells"</span>,</span>
<span>        <span class="st">"Fibroblasts"</span>,</span>
<span>        <span class="st">"Lymphocytes"</span>,</span>
<span>        <span class="st">"Endothelial cells"</span>,</span>
<span>        <span class="st">"Macrophages"</span>,</span>
<span>        <span class="st">"MEF-derived"</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">cluster_labels</span> <span class="op">&lt;-</span> <span class="va">embedding</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">cluster</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span></span>
<span>        x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>        y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">plot_embedding</span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">embedding</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">x_column</span>, <span class="va">y_column</span><span class="op">)</span><span class="op">]</span>,</span>
<span>    color <span class="op">=</span> <span class="va">embedding</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>            color_group <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span></span>
<span>                <span class="va">group</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Reprogrammed"</span>, <span class="st">"Control"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"MEF-derived"</span>,</span>
<span>                <span class="cn">TRUE</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">cluster</span><span class="op">)</span></span>
<span>            <span class="op">)</span></span>
<span>        <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">color_group</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    label <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    color_labels <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    color_legend <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    sort_values <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    rasterise <span class="op">=</span> <span class="va">RASTERISED</span>,</span>
<span>    geom_point_size <span class="op">=</span> <span class="va">GEOM_POINT_SIZE</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme_customized_embedding</span><span class="op">(</span>void <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span></span>
<span>        values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">color_palette</span>, <span class="st">"MEF-derived"</span> <span class="op">=</span> <span class="st">"salmon"</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment</a></span><span class="op">(</span></span>
<span>        data <span class="op">=</span> <span class="va">cell_type_segments</span>,</span>
<span>        <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, xend <span class="op">=</span> <span class="va">xend</span>, y <span class="op">=</span> <span class="va">y</span>, yend <span class="op">=</span> <span class="va">yend</span><span class="op">)</span>,</span>
<span>        color <span class="op">=</span> <span class="st">"grey50"</span>,</span>
<span>        size <span class="op">=</span> <span class="fl">.2</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span></span>
<span>        data <span class="op">=</span> <span class="va">cell_type_labels</span>,</span>
<span>        <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, label <span class="op">=</span> <span class="va">label</span><span class="op">)</span>,</span>
<span>        color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"black"</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"#00BFC4"</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"black"</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"#FF5722"</span><span class="op">)</span>,</span>
<span>        size <span class="op">=</span> <span class="fl">2.8</span>,</span>
<span>        family <span class="op">=</span> <span class="st">"Arial"</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span></span>
<span>        geom <span class="op">=</span> <span class="st">"text"</span>,</span>
<span>        family <span class="op">=</span> <span class="st">"Arial"</span>,</span>
<span>        x <span class="op">=</span> <span class="va">cluster_labels</span><span class="op">[</span>, <span class="st">"x"</span><span class="op">]</span>,</span>
<span>        y <span class="op">=</span> <span class="va">cluster_labels</span><span class="op">[</span>, <span class="st">"y"</span><span class="op">]</span>, label <span class="op">=</span> <span class="va">cluster_labels</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>,</span>
<span>        parse <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>        size <span class="op">=</span> <span class="fl">2</span>,</span>
<span>        color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"black"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="unbiased_reprogramming_files/figure-html/unnamed-chunk-33-1.png" style="width:100.0%;height:100.0%" class="figure-img"></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">pdf_width</span> <span class="op">&lt;-</span> <span class="fl">104</span></span>
<span><span class="va">pdf_height</span> <span class="op">&lt;-</span> <span class="fl">74</span></span>
<span><span class="va">file_name</span> <span class="op">&lt;-</span> <span class="fu">glue</span><span class="fu">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html">glue</a></span><span class="op">(</span></span>
<span>    <span class="st">"Rplot_embedding_dropseq_{EMBEDDING_TITLE_PREFIX}_"</span>,</span>
<span>    <span class="st">"cell_group_{pdf_width}_{pdf_height}.pdf"</span></span>
<span><span class="op">)</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/files.html">file.exists</a></span><span class="op">(</span><span class="va">file_name</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave</a></span><span class="op">(</span></span>
<span>        filename <span class="op">=</span> <span class="va">file_name</span>,</span>
<span>        useDingbats <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>        plot <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/last_plot.html">last_plot</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        device <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>        path <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>        scale <span class="op">=</span> <span class="fl">1</span>,</span>
<span>        width <span class="op">=</span> <span class="va">pdf_width</span>,</span>
<span>        height <span class="op">=</span> <span class="va">pdf_height</span>,</span>
<span>        units <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"mm"</span><span class="op">)</span>,</span>
<span>    <span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="composition" class="level3"><h3 class="anchored" data-anchor-id="composition">Composition</h3>
<p>Bar charts indicating the cellar composition of t-SNE clusters defined in <a href="https://www.sciencedirect.com/science/article/pii/S2211124719307089#fig2">Figure 1B</a>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">calc_group_composition</span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">embedding</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"cluster"</span>,</span>
<span>    group <span class="op">=</span> <span class="st">"group"</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>        cluster <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span></span>
<span>            <span class="va">cluster</span>,</span>
<span>            levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>                <span class="fl">19</span>, <span class="fl">18</span>,</span>
<span>                <span class="fl">9</span>, <span class="fl">6</span>, <span class="fl">11</span>, <span class="fl">4</span>, <span class="fl">8</span>, <span class="fl">21</span>,</span>
<span>                <span class="fl">3</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">10</span>, <span class="fl">17</span>, <span class="fl">22</span>, <span class="fl">20</span>,</span>
<span>                <span class="fl">13</span>, <span class="fl">7</span>, <span class="fl">14</span>, <span class="fl">12</span>, <span class="fl">15</span>, <span class="fl">5</span>, <span class="fl">16</span></span>
<span>            <span class="op">)</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">plot_barplot</span><span class="op">(</span></span>
<span>        x <span class="op">=</span> <span class="st">"cluster"</span>,</span>
<span>        y <span class="op">=</span> <span class="st">"percentage"</span>,</span>
<span>        z <span class="op">=</span> <span class="st">"group"</span>,</span>
<span>        legend_ncol <span class="op">=</span> <span class="fl">1</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span></span>
<span>        values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>            Primary <span class="op">=</span> <span class="st">"#00AFBB"</span>,</span>
<span>            Reprogrammed <span class="op">=</span> <span class="st">"#8BC34A"</span>,</span>
<span>            Control <span class="op">=</span> <span class="st">"#E7B800"</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="unbiased_reprogramming_files/figure-html/unnamed-chunk-34-1.png" style="width:100.0%;height:100.0%" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section></section><section id="expression" class="level2"><h2 class="anchored" data-anchor-id="expression">Expression</h2>
<section id="embedding-2" class="level3"><h3 class="anchored" data-anchor-id="embedding-2">Embedding</h3>
<div class="cell">
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">FEATURES_SELECTED</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"ENSMUSG00000009471_Myod1"</span>,</span>
<span>    <span class="st">"ENSMUSG00000026414_Tnnt2"</span>,</span>
<span>    <span class="st">"ENSMUSG00000016458_Wt1"</span>,</span>
<span>    <span class="st">"ENSMUSG00000025105_Bnc1"</span>,</span>
<span>    <span class="st">"ENSMUSG00000049382_Krt8"</span>,</span>
<span>    <span class="st">"ENSMUSG00000079018_Ly6c1"</span>,</span>
<span>    <span class="st">"ENSMUSG00000049436_Upk1b"</span>,</span>
<span>    <span class="st">"ENSMUSG00000021391_Cenpp"</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span><span class="op">(</span><span class="va">FEATURES_SELECTED</span>, \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">selected_feature</span> <span class="op">&lt;-</span> <span class="va">x</span></span>
<span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="va">selected_feature</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span>    <span class="va">values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span></span>
<span>        <span class="fu">calc_cpm</span><span class="op">(</span><span class="va">matrix_readcount_use</span><span class="op">[</span>, <span class="va">embedding</span><span class="op">$</span><span class="va">cell</span><span class="op">]</span><span class="op">)</span></span>
<span>        <span class="op">[</span><span class="va">selected_feature</span>, <span class="op">]</span> <span class="op">+</span> <span class="fl">1</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span>    <span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">plot_embedding</span><span class="op">(</span></span>
<span>        data <span class="op">=</span> <span class="va">embedding</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">x_column</span>, <span class="va">y_column</span><span class="op">)</span><span class="op">]</span>,</span>
<span>        color <span class="op">=</span> <span class="va">values</span>,</span>
<span>        label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span></span>
<span>            <span class="va">EMBEDDING_TITLE_PREFIX</span>,</span>
<span>            <span class="va">selected_feature</span> <span class="op">|&gt;</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_remove.html">str_remove</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"^E.+_"</span><span class="op">)</span>,</span>
<span>            sep <span class="op">=</span> <span class="st">"; "</span></span>
<span>        <span class="op">)</span>,</span>
<span>        color_legend <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>        sort_values <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>        rasterise <span class="op">=</span> <span class="va">RASTERISED</span>,</span>
<span>        geom_point_size <span class="op">=</span> <span class="va">GEOM_POINT_SIZE</span> <span class="op">*</span> <span class="fl">1.25</span>,</span>
<span>        na_value <span class="op">=</span> <span class="st">"grey80"</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu">theme_customized_embedding</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">p1</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="co"># unlist(recursive = FALSE) |&gt;</span></span>
<span>    <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/reduce.html">reduce</a></span><span class="op">(</span><span class="va">`+`</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">patchwork</span><span class="fu">::</span><span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html">plot_layout</a></span><span class="op">(</span>ncol <span class="op">=</span> <span class="fl">2</span>, byrow <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">patchwork</span><span class="fu">::</span><span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_annotation.html">plot_annotation</a></span><span class="op">(</span></span>
<span>        theme <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>plot.margin <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">margin</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ENSMUSG00000009471_Myod1 
ENSMUSG00000026414_Tnnt2 
ENSMUSG00000016458_Wt1 
ENSMUSG00000025105_Bnc1 
ENSMUSG00000049382_Krt8 
ENSMUSG00000079018_Ly6c1 
ENSMUSG00000049436_Upk1b 
ENSMUSG00000021391_Cenpp </code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="unbiased_reprogramming_files/figure-html/unnamed-chunk-36-1.png" style="width:90.0%;height:90.0%" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section><section id="violin" class="level3"><h3 class="anchored" data-anchor-id="violin">Violin</h3>
<p>Violin plot illustrating the expression of cardiac markers from single-cell expression data derived from P0 mouse heart and reprogrammed/uninfected MEFs.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">labels_y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>    <span class="fl">19</span>, <span class="fl">18</span>,</span>
<span>    <span class="fl">9</span>, <span class="fl">6</span>, <span class="fl">11</span>, <span class="fl">4</span>, <span class="fl">8</span>, <span class="fl">21</span>,</span>
<span>    <span class="fl">3</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">10</span>, <span class="fl">17</span>, <span class="fl">22</span>, <span class="fl">20</span>,</span>
<span>    <span class="fl">13</span>, <span class="fl">7</span>, <span class="fl">14</span>, <span class="fl">12</span>, <span class="fl">15</span>, <span class="fl">5</span>, <span class="fl">16</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">plot_violin</span><span class="op">(</span></span>
<span>    cells <span class="op">=</span> <span class="va">embedding</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>            cluster <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span></span>
<span>                <span class="va">cluster</span>,</span>
<span>                levels <span class="op">=</span> <span class="va">labels_y</span></span>
<span>            <span class="op">)</span></span>
<span>        <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/split.html">split</a></span><span class="op">(</span><span class="op">~</span><span class="va">cluster</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span><span class="op">(</span>\<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>            <span class="va">x</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">cell</span><span class="op">)</span></span>
<span>        <span class="op">}</span><span class="op">)</span>,</span>
<span>    features <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>        <span class="st">"ENSMUSG00000026414_Tnnt2"</span>,</span>
<span>        <span class="st">"ENSMUSG00000013936_Myl2"</span>,</span>
<span>        <span class="st">"ENSMUSG00000042045_Sln"</span>,</span>
<span>        <span class="st">"ENSMUSG00000001506_Col1a1"</span>,</span>
<span>        <span class="st">"ENSMUSG00000005836_Gata6"</span>,</span>
<span>        <span class="st">"ENSMUSG00000005583_Mef2c"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    matrix_cpm <span class="op">=</span> <span class="fu">calc_cpm</span><span class="op">(</span><span class="va">matrix_readcount_use</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme_customized_violin</span><span class="op">(</span></span>
<span>        axis_text_color_y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html">rev</a></span><span class="op">(</span><span class="va">color_palette</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">labels_y</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span></span>
<span>        values <span class="op">=</span> <span class="va">color_palette</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">labels_y</span><span class="op">)</span><span class="op">]</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span></span>
<span>        values <span class="op">=</span> <span class="va">color_palette</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">labels_y</span><span class="op">)</span><span class="op">]</span></span>
<span>    <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="unbiased_reprogramming_files/figure-html/unnamed-chunk-38-1.png" style="width:100.0%;height:100.0%" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section><section id="bar-plot" class="level3"><h3 class="anchored" data-anchor-id="bar-plot">Bar plot</h3>
<div class="cell">
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">barplot_helper</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">cells</span>, <span class="va">features</span>, <span class="va">matrix_readcount</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">cells</span><span class="op">)</span>, \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="fu">calc_cpm</span><span class="op">(</span><span class="va">matrix_readcount</span><span class="op">)</span><span class="op">[</span></span>
<span>            <span class="va">features</span>,</span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">matrix_readcount</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">cells</span><span class="op">[[</span><span class="va">x</span><span class="op">]</span><span class="op">]</span></span>
<span>        <span class="op">]</span> <span class="op">|&gt;</span></span>
<span>            <span class="fu">Matrix</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/colSums.html">rowMeans</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>            <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/enframe.html">enframe</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"feature"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>            <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>group <span class="op">=</span> <span class="va">x</span><span class="op">)</span></span>
<span>    <span class="op">}</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html">bind_rows</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Expression of Myod1 in MEF-derived cells.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cells_barplot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>    <span class="va">embedding</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span></span>
<span>            <span class="va">cluster</span> <span class="op">==</span> <span class="fl">20</span> <span class="op">&amp;</span> <span class="va">category</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="op">(</span><span class="st">"JD168"</span><span class="op">)</span></span>
<span>        <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">cell</span><span class="op">)</span>,</span>
<span>    <span class="va">embedding</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span></span>
<span>            <span class="va">cluster</span> <span class="op">!=</span> <span class="fl">20</span> <span class="op">&amp;</span> <span class="va">category</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="op">(</span><span class="st">"JD168"</span><span class="op">)</span></span>
<span>        <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">cell</span><span class="op">)</span>,</span>
<span>    <span class="va">embedding</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span></span>
<span>            <span class="va">category</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="op">(</span><span class="st">"JD174"</span><span class="op">)</span></span>
<span>        <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">cell</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">cells_barplot</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Cluster 20"</span>, <span class="st">"Other"</span>, <span class="st">"Uninfected"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">features_barplot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"ENSMUSG00000009471_Myod1"</span>,</span>
<span>    <span class="st">"ENSMUSG00000016458_Wt1"</span>,</span>
<span>    <span class="st">"ENSMUSG00000025105_Bnc1"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">barplot_helper</span><span class="op">(</span><span class="va">cells_barplot</span>, <span class="va">features_barplot</span>, <span class="va">matrix_readcount_use</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">feature</span> <span class="op">==</span> <span class="st">"ENSMUSG00000009471_Myod1"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>        feature <span class="op">=</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_remove.html">str_remove</a></span><span class="op">(</span>string <span class="op">=</span> <span class="va">feature</span>, pattern <span class="op">=</span> <span class="st">"^.+_"</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">value</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">plot_barplot_simple</span><span class="op">(</span></span>
<span>        x <span class="op">=</span> <span class="st">"group"</span>,</span>
<span>        y <span class="op">=</span> <span class="st">"value"</span>,</span>
<span>        z <span class="op">=</span> <span class="st">"feature"</span>,</span>
<span>        y_title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="st">"Avg expr; log"</span><span class="op">[</span><span class="fl">10</span><span class="op">]</span> <span class="op">*</span> <span class="st">" (CPM + 1)"</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme_customized_violin</span><span class="op">(</span></span>
<span>        strip_background_fill <span class="op">=</span> <span class="st">"grey80"</span>,</span>
<span>        panel_border_color <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>        axis_text_x_angle <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">90</span>, <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span></span>
<span>        values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>                <span class="st">"#FF5722"</span>,</span>
<span>                <span class="st">"grey35"</span>,</span>
<span>                <span class="st">"grey35"</span></span>
<span>            <span class="op">)</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="unbiased_reprogramming_files/figure-html/unnamed-chunk-42-1.png" style="width:25.0%;height:25.0%" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Expression of Wt1 and Bnc1 in MEF-derived cells.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cells_barplot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>    <span class="va">embedding</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span></span>
<span>            <span class="va">cluster</span> <span class="op">==</span> <span class="fl">12</span>,</span>
<span>            <span class="op">!</span><span class="va">category</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"JD168"</span>, <span class="st">"JD174"</span><span class="op">)</span></span>
<span>        <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">cell</span><span class="op">)</span>,</span>
<span>    <span class="va">embedding</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span></span>
<span>            <span class="va">cluster</span> <span class="op">==</span> <span class="fl">12</span> <span class="op">&amp;</span> <span class="va">category</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="op">(</span><span class="st">"JD168"</span><span class="op">)</span></span>
<span>        <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">cell</span><span class="op">)</span>,</span>
<span>    <span class="va">embedding</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span></span>
<span>            <span class="va">cluster</span> <span class="op">!=</span> <span class="fl">12</span> <span class="op">&amp;</span> <span class="va">category</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="op">(</span><span class="st">"JD168"</span><span class="op">)</span></span>
<span>        <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">cell</span><span class="op">)</span>,</span>
<span>    <span class="va">embedding</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span></span>
<span>            <span class="va">category</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="op">(</span><span class="st">"JD174"</span><span class="op">)</span></span>
<span>        <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">cell</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">cells_barplot</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Primarry epi."</span>, <span class="st">"Cluster 12"</span>, <span class="st">"Other"</span>, <span class="st">"Uninfected"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">barplot_helper</span><span class="op">(</span><span class="va">cells_barplot</span>, <span class="va">features_barplot</span>, <span class="va">matrix_readcount_use</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">feature</span> <span class="op">!=</span> <span class="st">"ENSMUSG00000009471_Myod1"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>        feature <span class="op">=</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_remove.html">str_remove</a></span><span class="op">(</span>string <span class="op">=</span> <span class="va">feature</span>, pattern <span class="op">=</span> <span class="st">"^.+_"</span><span class="op">)</span>,</span>
<span>        feature <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span></span>
<span>            <span class="va">feature</span>,</span>
<span>            levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Wt1"</span>, <span class="st">"Bnc1"</span><span class="op">)</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>        value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">value</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>        group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span></span>
<span>            <span class="va">group</span>,</span>
<span>            levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">cells_barplot</span><span class="op">)</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">plot_barplot_simple</span><span class="op">(</span></span>
<span>        x <span class="op">=</span> <span class="st">"group"</span>,</span>
<span>        y <span class="op">=</span> <span class="st">"value"</span>,</span>
<span>        z <span class="op">=</span> <span class="st">"feature"</span>,</span>
<span>        y_title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="st">"Avg expr; log"</span><span class="op">[</span><span class="fl">10</span><span class="op">]</span> <span class="op">*</span> <span class="st">" (CPM + 1)"</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme_customized_violin</span><span class="op">(</span></span>
<span>        strip_background_fill <span class="op">=</span> <span class="st">"grey80"</span>,</span>
<span>        panel_border_color <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>        axis_text_x_angle <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">90</span>, <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span></span>
<span>        values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>                <span class="st">"#00BFC4"</span>,</span>
<span>                <span class="st">"#FF5722"</span>,</span>
<span>                <span class="st">"grey35"</span>,</span>
<span>                <span class="st">"grey35"</span></span>
<span>            <span class="op">)</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="unbiased_reprogramming_files/figure-html/unnamed-chunk-43-1.png" style="width:50.0%;height:50.0%" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section><section id="lollipop" class="level3"><h3 class="anchored" data-anchor-id="lollipop">Lollipop</h3>
<p>10 TFs differentially expressed in primary epicardial cells compared with uninfected MEFs. Shown is the expression of 10F in MEFs and P0 mouse heart cells.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cells_lollipop</span> <span class="op">&lt;-</span> <span class="va">embedding</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span></span>
<span>        <span class="op">!</span><span class="va">cluster</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">10</span>, <span class="fl">17</span>, <span class="fl">20</span>, <span class="fl">22</span><span class="op">)</span>,</span>
<span>        <span class="op">!</span><span class="va">category</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"JD168"</span>, <span class="st">"JD174"</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/split.html">split</a></span><span class="op">(</span><span class="op">~</span><span class="va">cluster</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span><span class="op">(</span>\<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">x</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">cell</span><span class="op">)</span></span>
<span>    <span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cells_lollipop</span> <span class="op">&lt;-</span> <span class="va">cells_lollipop</span><span class="op">[</span></span>
<span>    <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map_lgl</a></span><span class="op">(</span><span class="va">cells_lollipop</span>, \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="op">]</span></span>
<span></span>
<span><span class="va">cells_lollipop</span><span class="op">$</span><span class="va">control</span> <span class="op">&lt;-</span> <span class="va">embedding</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">category</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"JD168"</span>, <span class="st">"JD174"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">cell</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">labels_y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"12"</span>, <span class="st">"control"</span>, <span class="st">"19"</span>, <span class="st">"18"</span>, <span class="st">"9"</span>, <span class="st">"6"</span>, <span class="st">"11"</span>, <span class="st">"4"</span>, <span class="st">"8"</span>,</span>
<span>    <span class="st">"21"</span>, <span class="st">"13"</span>, <span class="st">"7"</span>, <span class="st">"14"</span>, <span class="st">"15"</span>, <span class="st">"5"</span>, <span class="st">"16"</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">plot_lollipop</span><span class="op">(</span></span>
<span>    cells <span class="op">=</span> <span class="va">cells_lollipop</span><span class="op">[</span><span class="va">labels_y</span><span class="op">]</span>,</span>
<span>    features <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>        <span class="st">"ENSMUSG00000026628_Atf3"</span>,</span>
<span>        <span class="st">"ENSMUSG00000016458_Wt1"</span>,</span>
<span>        <span class="st">"ENSMUSG00000025105_Bnc1"</span>,</span>
<span>        <span class="st">"ENSMUSG00000051910_Sox6"</span>,</span>
<span>        <span class="st">"ENSMUSG00000045680_Tcf21"</span>,</span>
<span>        <span class="st">"ENSMUSG00000038193_Hand2"</span>,</span>
<span>        <span class="st">"ENSMUSG00000031965_Tbx20"</span>,</span>
<span>        <span class="st">"ENSMUSG00000032419_Tbx18"</span>,</span>
<span>        <span class="st">"ENSMUSG00000005836_Gata6"</span>,</span>
<span>        <span class="st">"ENSMUSG00000036098_Myrf"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    matrix_cpm <span class="op">=</span> <span class="fu">calc_cpm</span><span class="op">(</span><span class="va">matrix_readcount_use</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html">scale_y_discrete</a></span><span class="op">(</span></span>
<span>        name <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>        labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>            <span class="st">"Epicardial cell"</span>,</span>
<span>            <span class="st">"Uninfected MEF"</span>,</span>
<span>            <span class="st">"CM 2"</span>,</span>
<span>            <span class="st">"CM 1"</span>,</span>
<span>            <span class="st">"Atrial CM"</span>,</span>
<span>            <span class="st">"Atrial CM"</span>,</span>
<span>            <span class="st">"Atrial CM"</span>,</span>
<span>            <span class="st">"Atrial CM"</span>,</span>
<span>            <span class="st">"Ventricular CM"</span>,</span>
<span>            <span class="st">"CM 3"</span>,</span>
<span>            <span class="st">"Cardiac fibroblast"</span>,</span>
<span>            <span class="st">"Cardiac fibroblast"</span>,</span>
<span>            <span class="st">"Cardiac fibroblast"</span>,</span>
<span>            <span class="st">"Macrophage"</span>,</span>
<span>            <span class="st">"Endothelial cell"</span>,</span>
<span>            <span class="st">"Lymphocyte"</span></span>
<span>        <span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html">rev</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme_customized_violin</span><span class="op">(</span></span>
<span>        axis_text_x_angle <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">45</span>, <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>        axis_text_color_y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">color_palette</span>, control <span class="op">=</span> <span class="st">"grey35"</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/rev.html">rev</a></span><span class="op">(</span><span class="va">labels_y</span><span class="op">)</span><span class="op">]</span>,</span>
<span>        panel_grid_major <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>    <span class="op">)</span> <span class="op"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html">%+replace%</a></span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span></span>
<span>        legend.margin <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">margin</a></span><span class="op">(</span></span>
<span>            t <span class="op">=</span> <span class="fl">0</span>, r <span class="op">=</span> <span class="fl">0</span>, b <span class="op">=</span> <span class="fl">0</span>, l <span class="op">=</span> <span class="fl">0</span>, unit <span class="op">=</span> <span class="st">"mm"</span></span>
<span>        <span class="op">)</span>,</span>
<span>        legend.key.size <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">2.5</span>, <span class="st">"mm"</span><span class="op">)</span>,</span>
<span>        legend.key.width <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">4.0</span>, <span class="st">"mm"</span><span class="op">)</span>,</span>
<span>        legend.text <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>family <span class="op">=</span> <span class="st">"Arial"</span>, size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span>
<span>        legend.title <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>family <span class="op">=</span> <span class="st">"Arial"</span>, size <span class="op">=</span> <span class="fl">6</span><span class="op">)</span>,</span>
<span>        legend.position <span class="op">=</span> <span class="st">"bottom"</span>,</span>
<span>        legend.box <span class="op">=</span> <span class="st">"vertical"</span> <span class="co"># "horizontal"</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_size.html">scale_size</a></span><span class="op">(</span></span>
<span>        name <span class="op">=</span> <span class="st">"% cells expressing gene"</span>,</span>
<span>        breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">.2</span><span class="op">)</span>,</span>
<span>        labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">.2</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>,</span>
<span>        limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>        range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">6</span><span class="op">)</span>,</span>
<span>        guide <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html">guide_legend</a></span><span class="op">(</span></span>
<span>            title.position <span class="op">=</span> <span class="st">"top"</span>,</span>
<span>            title.hjust <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>            label.position <span class="op">=</span> <span class="st">"bottom"</span>,</span>
<span>            nrow <span class="op">=</span> <span class="fl">1</span>,</span>
<span>            byrow <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>            order <span class="op">=</span> <span class="fl">1</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_color_viridis_c</a></span><span class="op">(</span></span>
<span>        name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Avg expr; log"</span><span class="op">[</span><span class="fl">10</span><span class="op">]</span>, <span class="st">"( CPM + 1)"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        guide <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_colourbar.html">guide_colourbar</a></span><span class="op">(</span></span>
<span>            title.position <span class="op">=</span> <span class="st">"top"</span>,</span>
<span>            title.hjust <span class="op">=</span> <span class="fl">1</span>,</span>
<span>            barwidth <span class="op">=</span> <span class="fl">5</span>,</span>
<span>            barheight <span class="op">=</span> <span class="fl">0.6</span>,</span>
<span>            direction <span class="op">=</span> <span class="st">"horizontal"</span>,</span>
<span>            order <span class="op">=</span> <span class="fl">2</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="unbiased_reprogramming_files/figure-html/unnamed-chunk-47-1.png" style="width:60.0%;height:60.0%" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section></section><section id="gene-ontology-enrichment" class="level2"><h2 class="anchored" data-anchor-id="gene-ontology-enrichment">Gene Ontology enrichment</h2>
<p>Gene ontology analysis for genes highly expressed in Cluster 20.</p>
<div class="cell">
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/message.html">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">topGO</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
groupGOTerms:   GOBPTerm, GOMFTerm, GOCCTerm environments built.</code></pre>
</div>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/packageDescription.html">packageVersion</a></span><span class="op">(</span><span class="st">"topGO"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] '2.48.0'</code></pre>
</div>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/packageDescription.html">packageVersion</a></span><span class="op">(</span><span class="st">"org.Mm.eg.db"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] '3.15.0'</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">de_paired</span> <span class="op">&lt;-</span> <span class="fu">detect_de</span><span class="op">(</span></span>
<span>    cell_group_a <span class="op">=</span> <span class="va">embedding</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span></span>
<span>            <span class="va">category</span> <span class="op">==</span> <span class="st">"JD168"</span>,</span>
<span>            <span class="va">cluster</span> <span class="op">==</span> <span class="fl">20</span></span>
<span>        <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">cell</span><span class="op">)</span>,</span>
<span>    cell_group_b <span class="op">=</span> <span class="va">embedding</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span></span>
<span>            <span class="va">category</span> <span class="op">==</span> <span class="st">"JD168"</span>,</span>
<span>            <span class="va">cluster</span> <span class="op">!=</span> <span class="fl">20</span></span>
<span>        <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">cell</span><span class="op">)</span>,</span>
<span>    matrix_readcount <span class="op">=</span> <span class="va">matrix_readcount_use</span>,</span>
<span>    matrix_cpm <span class="op">=</span> <span class="fu">calc_cpm</span><span class="op">(</span><span class="va">matrix_readcount_use</span><span class="op">)</span></span>
<span>    <span class="co"># only_enrichment = TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">de_paired</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                           log2_effect          pval positive_frac_a
ENSMUSG00000037139_Myom3      8.166286 3.152517e-219           0.604
ENSMUSG00000079588_Tmem182    8.050808 5.009801e-140           0.402
ENSMUSG00000026251_Chrnd      7.992256  5.311037e-81           0.238
ENSMUSG00000087591_Gm14635    7.975343 2.164927e-110           0.323
ENSMUSG00000101680_Gm29015    7.963194  4.971533e-89           0.262
ENSMUSG00000102717_Gm37759    7.876779 1.253173e-149           0.439
                           positive_frac_b norm_reads_mean_a norm_reads_mean_b
ENSMUSG00000037139_Myom3             0.002         1.5196756      0.0018586658
ENSMUSG00000079588_Tmem182           0.002         0.8570739      0.0008143528
ENSMUSG00000026251_Chrnd             0.001         0.2803849      0.0004863366
ENSMUSG00000087591_Gm14635           0.001         0.6266815      0.0006813209
ENSMUSG00000101680_Gm29015           0.001         0.4385369      0.0020254669
ENSMUSG00000102717_Gm37759           0.002         0.7279072      0.0018620079
                           log2_fc_norm_reads cpm_meam_a cpm_meam_b log2_fc_cpm
ENSMUSG00000037139_Myom3             7.011140  177.63879 0.21767902    9.607811
ENSMUSG00000079588_Tmem182           6.325136  100.13546 0.09540360    9.891957
ENSMUSG00000026251_Chrnd             4.791384   32.73270 0.05698473    8.933125
ENSMUSG00000087591_Gm14635           5.897410   73.21501 0.07976347    9.671992
ENSMUSG00000101680_Gm29015           5.221062   51.29588 0.23699159    7.698518
ENSMUSG00000102717_Gm37759           5.959019   85.12481 0.21819530    8.543336
                                pval_adj
ENSMUSG00000037139_Myom3   6.067921e-219
ENSMUSG00000079588_Tmem182 8.772996e-140
ENSMUSG00000026251_Chrnd    8.352273e-81
ENSMUSG00000087591_Gm14635 3.606077e-110
ENSMUSG00000101680_Gm29015  7.951628e-89
ENSMUSG00000102717_Gm37759 2.229182e-149</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">de_paired</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1126   11</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">genes_of_interest</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html">rownames</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/subset.html">subset</a></span><span class="op">(</span><span class="va">de_paired</span>, <span class="va">log2_effect</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">gene_universe</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html">rownames</a></span><span class="op">(</span><span class="va">matrix_readcount_use</span><span class="op">)</span></span>
<span><span class="va">genes_formatted</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span><span class="op">(</span><span class="va">gene_universe</span> <span class="op"><a href="https://rdrr.io/pkg/BiocGenerics/man/match.html">%in%</a></span> <span class="va">genes_of_interest</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">genes_formatted</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">gene_universe</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">genes_formatted</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">genes_formatted</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_remove.html">str_remove</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"_.+$"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">topgo_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/methods/new.html">new</a></span><span class="op">(</span></span>
<span>    <span class="st">"topGOdata"</span>,</span>
<span>    ontology <span class="op">=</span> <span class="st">"BP"</span>,</span>
<span>    allGenes <span class="op">=</span> <span class="va">genes_formatted</span>,</span>
<span>    annot <span class="op">=</span> <span class="va">annFUN.org</span>,</span>
<span>    mapping <span class="op">=</span> <span class="st">"org.Mm.eg.db"</span>,</span>
<span>    ID <span class="op">=</span> <span class="st">"Ensembl"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Building most specific GOs .....</span></span>
<span><span class="co">## Loading required package: org.Mm.eg.db</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  ( 12572 GO terms found. )</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Build GO DAG topology ..........</span></span>
<span><span class="co">##  ( 15958 GO terms and 36406 relations. )</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Annotating nodes ...............</span></span>
<span><span class="co">##  ( 21155 genes annotated to the GO terms. )</span></span>
<span></span>
<span><span class="va">topgo_out_classic_fisher</span> <span class="op">&lt;-</span> <span class="fu">topGO</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/topGO/man/getSigGroups.html">runTest</a></span><span class="op">(</span></span>
<span>    <span class="va">topgo_data</span>,</span>
<span>    algorithm <span class="op">=</span> <span class="st">"classic"</span>,</span>
<span>    statistic <span class="op">=</span> <span class="st">"fisher"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##           -- Classic Algorithm -- </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##       the algorithm is scoring 5220 nontrivial nodes</span></span>
<span><span class="co">##       parameters: </span></span>
<span><span class="co">##           test statistic: fisher</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">NUM_GO_TERMS</span> <span class="op">&lt;-</span> <span class="fl">15</span></span>
<span></span>
<span><span class="co"># prepare data</span></span>
<span><span class="va">enriched_gos</span> <span class="op">&lt;-</span> <span class="fu">topGO</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/topGO/man/diagnosticMethods.html">GenTable</a></span><span class="op">(</span><span class="va">topgo_data</span>,</span>
<span>    classicFisher <span class="op">=</span> <span class="va">topgo_out_classic_fisher</span>,</span>
<span>    topNodes <span class="op">=</span> <span class="va">NUM_GO_TERMS</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>        classicFisher <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span></span>
<span>            <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html">str_replace</a></span><span class="op">(</span><span class="va">classicFisher</span>, <span class="st">"&lt; "</span>, <span class="st">""</span><span class="op">)</span></span>
<span>        <span class="op">)</span>,</span>
<span>        Term <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/AnnotationDbi/man/GOTerms-class.html">Term</a></span><span class="op">(</span><span class="va">GO.ID</span><span class="op">)</span>,</span>
<span>            levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html">rev</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/AnnotationDbi/man/GOTerms-class.html">Term</a></span><span class="op">(</span><span class="va">GO.ID</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span></span>
<span>    <span class="va">enriched_gos</span>,</span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span></span>
<span>        y <span class="op">=</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">classicFisher</span><span class="op">)</span>,</span>
<span>        x <span class="op">=</span> <span class="va">Term</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, fill <span class="op">=</span> <span class="st">"grey70"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span></span>
<span>        name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html">paste</a></span><span class="op">(</span><span class="st">"-log"</span><span class="op">[</span><span class="fl">10</span><span class="op">]</span>, <span class="st">" (p-value)"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">30</span><span class="op">)</span>,</span>
<span>        labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/parse_format.html">math_format</a></span><span class="op">(</span><span class="fl">10</span><span class="op">^</span><span class="va">.x</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span></span>
<span>        geom <span class="op">=</span> <span class="st">"text"</span>,</span>
<span>        x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/nrow.html">nrow</a></span><span class="op">(</span><span class="va">enriched_gos</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/nrow.html">nrow</a></span><span class="op">(</span><span class="va">enriched_gos</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html">rev</a></span><span class="op">(</span><span class="va">enriched_gos</span><span class="op">$</span><span class="va">Term</span><span class="op">)</span>,</span>
<span>        <span class="co"># vjust = "inward",</span></span>
<span>        hjust <span class="op">=</span> <span class="st">"inward"</span>,</span>
<span>        size <span class="op">=</span> <span class="fl">2.5</span>,</span>
<span>        family <span class="op">=</span> <span class="st">"Arial"</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span></span>
<span>        axis.title <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>family <span class="op">=</span> <span class="st">"Arial"</span>, size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>,</span>
<span>        axis.title.y <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        axis.text <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>family <span class="op">=</span> <span class="st">"Arial"</span>, size <span class="op">=</span> <span class="fl">7</span><span class="op">)</span>,</span>
<span>        axis.text.y <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        axis.ticks.y <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        axis.line.y <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        legend.text <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>family <span class="op">=</span> <span class="st">"Arial"</span>, size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>,</span>
<span>        legend.title <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>family <span class="op">=</span> <span class="st">"Arial"</span>, size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="unbiased_reprogramming_files/figure-html/unnamed-chunk-52-1.png" style="width:50.0%;height:50.0%" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section><section id="enrichment-of-exogenous-factors" class="level2 page-columns page-full"><h2 class="anchored" data-anchor-id="enrichment-of-exogenous-factors">Enrichment of exogenous factors</h2>
<div class="cell">
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># clusters_selected &lt;- c(1, 2, 3, 10, 12, 17, 20, 22)</span></span>
<span></span>
<span><span class="va">features_selected_43</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"ENSMUSG00000025930_Msc"</span>,</span>
<span>    <span class="st">"ENSMUSG00000026313_Hdac4"</span>,</span>
<span>    <span class="st">"ENSMUSG00000026565_Pou2f1"</span>,</span>
<span>    <span class="st">"ENSMUSG00000026923_Notch1"</span>,</span>
<span>    <span class="st">"ENSMUSG00000015846_Rxra"</span>,</span>
<span>    <span class="st">"ENSMUSG00000015627_Gata5"</span>,</span>
<span>    <span class="st">"ENSMUSG00000025860_Xiap"</span>,</span>
<span>    <span class="st">"ENSMUSG00000040289_Hey1"</span>,</span>
<span>    <span class="st">"ENSMUSG00000027833_Shox2"</span>,</span>
<span>    <span class="st">"ENSMUSG00000001419_Mef2d"</span>,</span>
<span>    <span class="st">"ENSMUSG00000028800_Hdac1"</span>,</span>
<span>    <span class="st">"ENSMUSG00000086369_E330017L17Rik"</span>,</span>
<span>    <span class="st">"ENSMUSG00000028949_Smarcd3"</span>,</span>
<span>    <span class="st">"ENSMUSG00000048450_Msx1"</span>,</span>
<span>    <span class="st">"ENSMUSG00000042002_Foxn4"</span>,</span>
<span>    <span class="st">"ENSMUSG00000018604_Tbx3"</span>,</span>
<span>    <span class="st">"ENSMUSG00000018263_Tbx5"</span>,</span>
<span>    <span class="st">"ENSMUSG00000063568_Jazf1"</span>,</span>
<span>    <span class="st">"ENSMUSG00000009471_Myod1"</span>,</span>
<span>    <span class="st">"ENSMUSG00000030557_Mef2a"</span>,</span>
<span>    <span class="st">"ENSMUSG00000030551_Nr2f2"</span>,</span>
<span>    <span class="st">"ENSMUSG00000030544_Mesp1"</span>,</span>
<span>    <span class="st">"ENSMUSG00000019789_Hey2"</span>,</span>
<span>    <span class="st">"ENSMUSG00000019777_Hdac2"</span>,</span>
<span>    <span class="st">"ENSMUSG00000020167_Tcf3"</span>,</span>
<span>    <span class="st">"ENSMUSG00000038193_Hand2"</span>,</span>
<span>    <span class="st">"ENSMUSG00000079033_Mef2b"</span>,</span>
<span>    <span class="st">"ENSMUSG00000021944_Gata4"</span>,</span>
<span>    <span class="st">"ENSMUSG00000032419_Tbx18"</span>,</span>
<span>    <span class="st">"ENSMUSG00000020160_Meis1"</span>,</span>
<span>    <span class="st">"ENSMUSG00000037335_Hand1"</span>,</span>
<span>    <span class="st">"ENSMUSG00000020542_Myocd"</span>,</span>
<span>    <span class="st">"ENSMUSG00000000093_Tbx2"</span>,</span>
<span>    <span class="st">"ENSMUSG00000021469_Msx2"</span>,</span>
<span>    <span class="st">"ENSMUSG00000005583_Mef2c"</span>,</span>
<span>    <span class="st">"ENSMUSG00000042258_Isl1"</span>,</span>
<span>    <span class="st">"ENSMUSG00000009739_Pou6f1"</span>,</span>
<span>    <span class="st">"ENSMUSG00000001288_Rarg"</span>,</span>
<span>    <span class="st">"ENSMUSG00000015579_Nkx2-5"</span>,</span>
<span>    <span class="st">"ENSMUSG00000023067_Cdkn1a"</span>,</span>
<span>    <span class="st">"ENSMUSG00000024063_Lbh"</span>,</span>
<span>    <span class="st">"ENSMUSG00000005836_Gata6"</span>,</span>
<span>    <span class="st">"ENSMUSG00000024515_Smad4"</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">clusters_selected</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">12</span>, <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">enriched_factors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/do.call.html">do.call</a></span><span class="op">(</span></span>
<span>    <span class="va">rbind.data.frame</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html">lapply</a></span><span class="op">(</span><span class="va">clusters_selected</span>, \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">cells_1</span> <span class="op">&lt;-</span> <span class="va">embedding</span><span class="op">$</span><span class="va">cell</span><span class="op">[</span></span>
<span>            <span class="va">embedding</span><span class="op">$</span><span class="va">cluster</span> <span class="op">==</span> <span class="va">x</span> <span class="op">&amp;</span> <span class="va">embedding</span><span class="op">$</span><span class="va">category</span> <span class="op">==</span> <span class="st">"JD168"</span></span>
<span>        <span class="op">]</span></span>
<span>        <span class="va">cells_2</span> <span class="op">&lt;-</span> <span class="va">embedding</span><span class="op">$</span><span class="va">cell</span><span class="op">[</span></span>
<span>            <span class="va">embedding</span><span class="op">$</span><span class="va">cluster</span> <span class="op">!=</span> <span class="va">x</span> <span class="op">&amp;</span> <span class="va">embedding</span><span class="op">$</span><span class="va">category</span> <span class="op">==</span> <span class="st">"JD168"</span></span>
<span>        <span class="op">]</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">cells_1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">cells_2</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span></span>
<span>        <span class="va">de_paired</span> <span class="op">&lt;-</span> <span class="fu">detect_de</span><span class="op">(</span></span>
<span>            cell_group_a <span class="op">=</span> <span class="va">cells_1</span>,</span>
<span>            cell_group_b <span class="op">=</span> <span class="va">cells_2</span>,</span>
<span>            matrix_readcount <span class="op">=</span> <span class="va">matrix_readcount_use</span>,</span>
<span>            matrix_cpm <span class="op">=</span> <span class="fu">calc_cpm</span><span class="op">(</span><span class="va">matrix_readcount_use</span><span class="op">)</span>,</span>
<span>            only_enrichment <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>        <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>            <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>category <span class="op">=</span> <span class="va">x</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>            <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">rownames_to_column</a></span><span class="op">(</span>var <span class="op">=</span> <span class="st">"feature"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>            <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">feature</span> <span class="op"><a href="https://rdrr.io/pkg/BiocGenerics/man/match.html">%in%</a></span> <span class="va">features_selected_43</span><span class="op">)</span></span>
<span>    <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">category</span> <span class="op"><a href="https://rdrr.io/pkg/BiocGenerics/man/match.html">%in%</a></span> <span class="va">clusters_selected</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>        category <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">category</span>,</span>
<span>            levels <span class="op">=</span> <span class="va">clusters_selected</span></span>
<span>        <span class="op">)</span>,</span>
<span>        symbol <span class="op">=</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_remove.html">str_remove</a></span><span class="op">(</span></span>
<span>            string <span class="op">=</span> <span class="va">feature</span>,</span>
<span>            pattern <span class="op">=</span> <span class="st">"^.+_"</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>20 164 8566 
12 201 8529 
2 2445 6285 </code></pre>
</div>
</div>
<p><br></p>
<p>Differential expression analysis of 48F in MEF-derived clusters, as compared with all other reprogrammed cells. Each dot represents a gene (colored by fold change and sized by p value).</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_abline</a></span><span class="op">(</span>intercept <span class="op">=</span> <span class="fl">0</span>, slope <span class="op">=</span> <span class="fl">1</span>, linetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span></span>
<span>        data <span class="op">=</span> <span class="va">enriched_factors</span>,</span>
<span>        <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">positive_frac_b</span>,</span>
<span>            <span class="va">positive_frac_a</span>,</span>
<span>            size <span class="op">=</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">pval_adj</span><span class="op">)</span>,</span>
<span>            color <span class="op">=</span> <span class="va">log2_effect</span></span>
<span>        <span class="op">)</span>,</span>
<span>        alpha <span class="op">=</span> <span class="fl">.8</span>,</span>
<span>        stroke <span class="op">=</span> <span class="fl">0</span>, shape <span class="op">=</span> <span class="fl">16</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span></span>
<span>        <span class="op">~</span><span class="va">category</span>,</span>
<span>        nrow <span class="op">=</span> <span class="fl">1</span>,</span>
<span>        labeller <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labeller.html">labeller</a></span><span class="op">(</span></span>
<span>            category <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html">setNames</a></span><span class="op">(</span></span>
<span>                object <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html">paste</a></span><span class="op">(</span><span class="st">"Cluster"</span>, <span class="va">clusters_selected</span><span class="op">)</span>,</span>
<span>                nm <span class="op">=</span> <span class="va">clusters_selected</span></span>
<span>            <span class="op">)</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html">coord_fixed</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_color_viridis_c</a></span><span class="op">(</span></span>
<span>        name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html">paste</a></span><span class="op">(</span><span class="st">"Log"</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="st">" effect"</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_size.html">scale_size_continuous</a></span><span class="op">(</span></span>
<span>        name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html">paste</a></span><span class="op">(</span><span class="st">"-log"</span><span class="op">[</span><span class="fl">10</span><span class="op">]</span>, <span class="st">" (p-value)"</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span></span>
<span>        color <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_colourbar.html">guide_colorbar</a></span><span class="op">(</span>order <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>        size <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html">guide_legend</a></span><span class="op">(</span>order <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span></span>
<span>        name <span class="op">=</span> <span class="st">"Expr (%, other reprogrammed cells)"</span>,</span>
<span>        limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">.2</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span></span>
<span>        name <span class="op">=</span> <span class="st">"Expr (%, indicated cluster)"</span>,</span>
<span>        limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">.2</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme_customized_violin</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html">%+replace%</a></span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span></span>
<span>        legend.background <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        legend.margin <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">margin</a></span><span class="op">(</span>t <span class="op">=</span> <span class="fl">0</span>, r <span class="op">=</span> <span class="fl">0</span>, b <span class="op">=</span> <span class="fl">0</span>, l <span class="op">=</span> <span class="fl">0</span>, unit <span class="op">=</span> <span class="st">"mm"</span><span class="op">)</span>,</span>
<span>        legend.key.size <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">2.5</span>, <span class="st">"mm"</span><span class="op">)</span>,</span>
<span>        legend.text <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>family <span class="op">=</span> <span class="st">"Arial"</span>, size <span class="op">=</span> <span class="fl">6</span><span class="op">)</span>,</span>
<span>        legend.title <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>family <span class="op">=</span> <span class="st">"Arial"</span>, size <span class="op">=</span> <span class="fl">7</span><span class="op">)</span>,</span>
<span>        legend.position <span class="op">=</span> <span class="st">"bottom"</span>,</span>
<span>        legend.box <span class="op">=</span> <span class="st">"horizontal"</span>,</span>
<span>        legend.box.background <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggrepel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html">geom_text_repel</a></span><span class="op">(</span></span>
<span>        data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/subset.html">subset</a></span><span class="op">(</span><span class="va">enriched_factors</span>, <span class="va">symbol</span> <span class="op"><a href="https://rdrr.io/pkg/BiocGenerics/man/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>            <span class="st">"Myod1"</span>, <span class="st">"Mef2b"</span>,</span>
<span>            <span class="st">"Mef2c"</span>, <span class="st">"Hand2"</span>, <span class="st">"Gata6"</span></span>
<span>        <span class="op">)</span><span class="op">)</span>,</span>
<span>        <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span></span>
<span>            <span class="va">positive_frac_b</span>,</span>
<span>            <span class="va">positive_frac_a</span>,</span>
<span>            label <span class="op">=</span> <span class="va">symbol</span></span>
<span>        <span class="op">)</span>,</span>
<span>        <span class="co">#</span></span>
<span>        size <span class="op">=</span> <span class="fl">5</span> <span class="op">/</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="va"><a href="https://ggplot2.tidyverse.org/reference/graphical-units.html">.pt</a></span>,</span>
<span>        family <span class="op">=</span> <span class="st">"Arial"</span>,</span>
<span>        box.padding <span class="op">=</span> <span class="fl">.2</span>,</span>
<span>        point.padding <span class="op">=</span> <span class="fl">.2</span>,</span>
<span>        nudge_y <span class="op">=</span> <span class="fl">.15</span>,</span>
<span>        arrow <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/arrow.html">arrow</a></span><span class="op">(</span>length <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">.02</span>, <span class="st">"npc"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        segment.color <span class="op">=</span> <span class="st">"grey35"</span>,</span>
<span>        color <span class="op">=</span> <span class="st">"black"</span></span>
<span>    <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display column-page">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="unbiased_reprogramming_files/figure-html/unnamed-chunk-55-1.png" style="width:80.0%;height:80.0%" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p><br></p>
</section><section id="r-session-info" class="level2"><h2 class="anchored" data-anchor-id="r-session-info">R session info</h2>
<div class="cell">
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://r-lib.github.io/sessioninfo/reference/session_info.html">session_info</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Session info 
 setting  value
 version  R version 4.2.2 (2022-10-31)
 os       macOS Ventura 13.2.1
 system   aarch64, darwin22.1.0
 ui       unknown
 language (EN)
 collate  en_US.UTF-8
 ctype    en_US.UTF-8
 tz       America/Chicago
 date     2023-03-08
 pandoc   2.19.2 @ /Users/jialei/.pyenv/shims/ (via rmarkdown)

 Packages 
 package          * version    date (UTC) lib source
 AnnotationDbi    * 1.58.0     2022-04-26 [1] Bioconductor
 Biobase          * 2.56.0     2022-04-26 [1] Bioconductor
 BiocGenerics     * 0.42.0     2022-04-26 [1] Bioconductor
 Biostrings         2.64.1     2022-08-18 [1] Bioconductor
 bit                4.0.5      2022-11-15 [1] CRAN (R 4.2.2)
 bit64              4.0.5      2020-08-30 [1] CRAN (R 4.2.2)
 bitops             1.0-7      2021-04-24 [1] CRAN (R 4.2.2)
 blob               1.2.3      2022-04-10 [1] CRAN (R 4.2.0)
 cachem             1.0.7      2023-02-24 [1] CRAN (R 4.2.2)
 callr              3.7.3      2022-11-02 [1] CRAN (R 4.2.2)
 cli                3.6.0      2023-01-09 [1] CRAN (R 4.2.2)
 colorspace         2.1-0      2023-01-23 [1] CRAN (R 4.2.2)
 commonmark         1.8.1      2022-10-14 [1] CRAN (R 4.2.1)
 crayon             1.5.2      2022-09-29 [1] CRAN (R 4.2.1)
 DBI                1.1.3      2022-06-18 [1] CRAN (R 4.2.0)
 devtools           2.4.5.9000 2023-03-08 [1] Github (r-lib/devtools@cfa1ba9)
 digest             0.6.31     2022-12-11 [1] CRAN (R 4.2.2)
 dplyr            * 1.1.0.9000 2023-03-08 [1] Github (tidyverse/dplyr@e12fd49)
 ellipsis           0.3.2      2021-04-29 [1] CRAN (R 4.2.2)
 evaluate           0.20       2023-01-17 [1] CRAN (R 4.2.2)
 extrafont        * 0.19       2023-01-18 [1] CRAN (R 4.2.2)
 extrafontdb        1.0        2012-06-11 [1] CRAN (R 4.2.0)
 fansi              1.0.4      2023-01-22 [1] CRAN (R 4.2.2)
 farver             2.1.1      2022-07-06 [1] CRAN (R 4.2.2)
 fastmap            1.1.1      2023-02-24 [1] CRAN (R 4.2.2)
 forcats          * 1.0.0.9000 2023-01-31 [1] Github (tidyverse/forcats@4a8525a)
 formattable      * 0.2.1      2021-01-07 [1] CRAN (R 4.2.1)
 fs                 1.6.1      2023-02-06 [1] CRAN (R 4.2.2)
 generics           0.1.3      2022-07-05 [1] CRAN (R 4.2.1)
 GenomeInfoDb       1.32.4     2022-09-06 [1] Bioconductor
 GenomeInfoDbData   1.2.8      2022-04-22 [1] Bioconductor
 ggplot2          * 3.4.1.9000 2023-03-08 [1] Github (tidyverse/ggplot2@04a5ef2)
 ggrepel            0.9.3      2023-02-03 [1] CRAN (R 4.2.2)
 glue               1.6.2.9000 2023-01-26 [1] Github (tidyverse/glue@794eb37)
 GO.db            * 3.15.0     2022-12-17 [1] Bioconductor
 graph            * 1.74.0     2022-04-26 [1] Bioconductor
 gt                 0.8.0.9000 2023-03-06 [1] Github (rstudio/gt@6272bc5)
 gtable             0.3.1.9000 2022-09-26 [1] Github (r-lib/gtable@2e33c5b)
 hms                1.1.2      2022-08-19 [1] CRAN (R 4.2.1)
 htmltools          0.5.4.9000 2023-02-23 [1] Github (rstudio/htmltools@48c46ed)
 htmlwidgets        1.6.1.9000 2023-01-08 [1] Github (ramnathv/htmlwidgets@843eee9)
 httpuv             1.6.9      2023-02-14 [1] CRAN (R 4.2.2)
 httr               1.4.5      2023-02-24 [1] CRAN (R 4.2.2)
 IRanges          * 2.30.1     2022-08-18 [1] Bioconductor
 jsonlite           1.8.4      2022-12-06 [1] CRAN (R 4.2.2)
 KEGGREST           1.36.3     2022-07-12 [1] Bioconductor
 knitr              1.42       2023-01-25 [1] CRAN (R 4.2.2)
 labeling           0.4.2      2020-10-20 [1] CRAN (R 4.2.0)
 later              1.3.0      2021-08-18 [1] CRAN (R 4.2.2)
 lattice            0.20-45    2021-09-22 [2] CRAN (R 4.2.2)
 lifecycle          1.0.3.9000 2023-03-08 [1] Github (r-lib/lifecycle@9ac73f5)
 lubridate        * 1.9.2      2023-02-10 [1] CRAN (R 4.2.2)
 magrittr           2.0.3      2022-03-30 [1] CRAN (R 4.2.2)
 Matrix           * 1.5-3      2022-11-11 [1] CRAN (R 4.2.2)
 matrixStats        0.63.0     2022-11-18 [1] CRAN (R 4.2.2)
 memoise            2.0.1      2021-11-26 [1] CRAN (R 4.2.0)
 mime               0.12       2021-09-28 [1] CRAN (R 4.2.2)
 miniUI             0.1.1.1    2018-05-18 [1] CRAN (R 4.2.0)
 munsell            0.5.0      2018-06-12 [1] CRAN (R 4.2.0)
 org.Mm.eg.db     * 3.15.0     2022-07-11 [1] Bioconductor
 patchwork        * 1.1.2.9000 2022-08-20 [1] Github (thomasp85/patchwork@c14c960)
 pillar             1.8.1      2022-08-19 [1] CRAN (R 4.2.1)
 pkgbuild           1.4.0.9000 2023-02-18 [1] Github (r-lib/pkgbuild@9ec92a0)
 pkgconfig          2.0.3      2019-09-22 [1] CRAN (R 4.2.0)
 pkgload            1.3.2      2022-11-16 [1] CRAN (R 4.2.2)
 png                0.1-8      2022-11-29 [1] CRAN (R 4.2.2)
 prettyunits        1.1.1.9000 2022-04-22 [1] Github (r-lib/prettyunits@8706d89)
 processx           3.8.0      2022-10-26 [1] CRAN (R 4.2.1)
 profvis            0.3.7      2020-11-02 [1] CRAN (R 4.2.2)
 promises           1.2.0.1    2021-02-11 [1] CRAN (R 4.2.2)
 ps                 1.7.2      2022-10-26 [1] CRAN (R 4.2.1)
 purrr            * 1.0.1.9000 2023-02-08 [1] Github (tidyverse/purrr@fd5a732)
 R.cache            0.16.0     2022-07-21 [1] CRAN (R 4.2.1)
 R.methodsS3        1.8.2      2022-06-13 [1] CRAN (R 4.2.0)
 R.oo               1.25.0     2022-06-12 [1] CRAN (R 4.2.0)
 R.utils            2.12.2     2022-11-11 [1] CRAN (R 4.2.2)
 R6                 2.5.1.9000 2022-10-29 [1] Github (r-lib/R6@e6b5eaf)
 ragg               1.2.5.9000 2023-03-08 [1] Github (r-lib/ragg@69ad967)
 Rcpp               1.0.10     2023-01-22 [1] CRAN (R 4.2.2)
 RCurl              1.98-1.10  2023-01-27 [1] CRAN (R 4.2.2)
 readr            * 2.1.4.9000 2023-03-02 [1] Github (tidyverse/readr@eeb8f6b)
 remotes            2.4.2.9000 2023-02-18 [1] Github (r-lib/remotes@1e12140)
 rlang              1.1.0      2023-03-08 [1] Github (r-lib/rlang@60159c7)
 rmarkdown          2.20.1     2023-02-10 [1] Github (rstudio/rmarkdown@a75dc37)
 RSQLite            2.3.0      2023-02-17 [1] CRAN (R 4.2.2)
 Rttf2pt1           1.3.12     2023-01-22 [1] CRAN (R 4.2.2)
 S4Vectors        * 0.34.0     2022-04-26 [1] Bioconductor
 sass               0.4.5      2023-01-24 [1] CRAN (R 4.2.2)
 scales             1.2.1.9000 2022-08-20 [1] Github (r-lib/scales@b3df2fb)
 sessioninfo        1.2.2      2021-12-06 [1] CRAN (R 4.2.0)
 shiny              1.7.4      2022-12-15 [1] CRAN (R 4.2.2)
 SparseM          * 1.81       2021-02-18 [1] CRAN (R 4.2.1)
 stringi            1.7.12     2023-01-11 [1] CRAN (R 4.2.2)
 stringr          * 1.5.0      2022-12-02 [1] CRAN (R 4.2.2)
 styler           * 1.9.1      2023-03-05 [1] Github (r-lib/styler@57bbf4e)
 systemfonts        1.0.4      2022-02-11 [1] CRAN (R 4.2.2)
 textshaping        0.3.6      2021-10-13 [1] CRAN (R 4.2.2)
 tibble           * 3.2.0.9000 2023-03-08 [1] Github (tidyverse/tibble@a310014)
 tidyr            * 1.3.0.9000 2023-01-25 [1] Github (tidyverse/tidyr@0764e65)
 tidyselect         1.2.0.9000 2023-03-08 [1] Github (r-lib/tidyselect@177a190)
 tidyverse        * 2.0.0.9000 2023-03-08 [1] Github (tidyverse/tidyverse@37018d1)
 timechange         0.2.0      2023-01-11 [1] CRAN (R 4.2.2)
 topGO            * 2.48.0     2022-04-26 [1] Bioconductor
 tzdb               0.3.0      2022-03-28 [1] CRAN (R 4.2.2)
 urlchecker         1.0.1      2021-11-30 [1] CRAN (R 4.2.0)
 usethis            2.1.6.9000 2023-03-08 [1] Github (r-lib/usethis@dac38d0)
 utf8               1.2.3      2023-01-31 [1] CRAN (R 4.2.2)
 vctrs              0.5.2.9000 2023-03-08 [1] Github (r-lib/vctrs@469411a)
 viridisLite        0.4.1      2022-08-22 [1] CRAN (R 4.2.1)
 vroom              1.6.1.9000 2023-02-10 [1] Github (r-lib/vroom@a7769d1)
 withr              2.5.0      2022-03-03 [1] CRAN (R 4.2.0)
 xfun               0.37       2023-01-31 [1] CRAN (R 4.2.2)
 xtable             1.8-4      2019-04-21 [1] CRAN (R 4.2.0)
 XVector            0.36.0     2022-04-26 [1] Bioconductor
 yaml               2.3.7      2023-01-23 [1] CRAN (R 4.2.2)
 zlibbioc           1.42.0     2022-04-26 [1] Bioconductor

 [1] /opt/homebrew/lib/R/4.2/site-library
 [2] /opt/homebrew/Cellar/r/4.2.2_1/lib/R/library

</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Styling  1  files:
 unbiased_reprogramming.qmd  

Status  Count   Legend 
   1   File unchanged.
   0   File changed.
   0   Styling threw an error.
</code></pre>
</div>
</div>


</section><div id="quarto-appendix" class="default"><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@article{duan2023,
  author = {Duan, Jialei and Li, Boxun and Bhakta, Minoti and Xie, Shiqi
    and Zhou, Pei and V.Munshi, Nikhil and C.Hon, Gary},
  publisher = {Cell Press},
  title = {Rational {Reprogramming} of {Cellular} {States} by
    {Combinatorial} {Perturbation}},
  journal = {Cell reports},
  volume = {27},
  number = {12},
  pages = {3486 - 3499000000},
  date = {2023-03-08},
  url = {https://doi.org/10.1016/j.celrep.2019.05.079},
  doi = {10.1016/j.celrep.2019.05.079},
  langid = {en},
  abstract = {Reprogram-Seq leverages organ-specific cell atlas data
    with single-cell perturbation and computational analysis to predict,
    evaluate, and optimize TF combinations that reprogram a cell type of
    interest.}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-duan2023" class="csl-entry quarto-appendix-citeas" role="listitem">
Duan, Jialei, Boxun Li, Minoti Bhakta, Shiqi Xie, Pei Zhou, Nikhil
V.Munshi, and Gary C.Hon. 2023. <span>Rational Reprogramming of
Cellular States by Combinatorial Perturbation.</span> <em>Cell
Reports</em> 27 (12): 34863499000000. <a href="https://doi.org/10.1016/j.celrep.2019.05.079">https://doi.org/10.1016/j.celrep.2019.05.079</a>.
</div></div></section></div></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp(/^(?:http:|https:)\/\/leafletjs\.com/);
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
      }
    }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
  </div>
  <div class="nav-page nav-page-next">
      <a href="./rational_epicardial_reprogramming.html" class="pagination-link">
        <span class="nav-page-text">Rational Reprogramming</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">Copyright  2023, Jialei Duan</div>   
    <div class="nav-footer-center">
      <ul class="footer-items list-unstyled">
<li class="nav-item">
    <a class="nav-link" href="https://github.com/jlduan/Reprogram-Seq/blob/master/LICENSE"><i class="fa-solid fa-file-lines" aria-label="file-lines"></i> License</a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="./about.html"><i class="fa-solid fa-circle-info" aria-label="circle-info"></i> About</a>
  </li>  
</ul>
</div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
<li class="nav-item compact">
    <a class="nav-link active" href="https://twitter.com/jlduan" aria-current="page">
      <i class="bi bi-twitter" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/jlduan/Reprogram-Seq">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
</ul>
</div>
  </div>
</footer>


</body></html>